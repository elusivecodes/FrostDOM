!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e:Object.assign(t,e(t))}(this||window,(function(t){"use strict";if(!t)throw new Error("FrostDOM requires a Window.");if(!("Core"in t))throw new Error("FrostDOM requires FrostCore.");const e=t.Core,s=t.document;class o{constructor(s){this._options=e.extend({},this.constructor.defaults,s),this._options.url||(this._options.url=t.location.href),this._options.cache||(this._options.url=this.constructor.appendQueryString(this._options.url,"_",Date.now())),!("Content-Type"in this._options.headers)&&this._options.contentType&&(this._options.headers["Content-Type"]=this._options.contentType),null===this._options.isLocal&&(this._options.isLocal=this.constructor._localRegExp.test(location.protocol)),this._options.isLocal||"X-Requested-With"in this._options.headers||(this._options.headers["X-Requested-With"]="XMLHttpRequest"),this._isResolved=!1,this._isRejected=!1,this._isCancelled=!1,this.promise=new Promise((t,e)=>{this._resolve=e=>{this._isResolved=!0,t(e)},this._reject=t=>{this._isRejected=!0,e(t)}}),this._build(),this._events(),this._send()}cancel(t="Request was cancelled"){this._isResolved||this._isRejected||this._isCancelled||(this._xhr.abort(),this._isCancelled=!0,this._options.rejectOnCancel&&this._reject({status:this._xhr.status,xhr:this._xhr,reason:t}))}catch(t){return this.promise.catch(t)}finally(t){return this.promise.finally(t)}then(t,e){return this.promise.then(t,e)}}class r{constructor(){this.data={headers:{}},this.status=200,this.timeout=0,this.upload={},this._response="Test"}abort(){clearTimeout(this._uploadTimer),clearTimeout(this._progressTimer),clearTimeout(this._completeTimer)}open(t,e,s=!0,o,r){this.data.method=t,this.data.url=e,this.data.async=s,this.data.username=o,this.data.password=r}overrideMimeType(t){this.data.mimeType=t}send(t=null){this.data.body=t,this.responseType&&(this.data.responseType=this.responseType),this.timeout&&(this.data.timeout=this.timeout),this.upload&&this.upload.onprogress&&(this._uploadTimer=setTimeout(t=>{this._uploadTimer=null;const e=new Event("progress");e.loaded=5e3,e.total=1e4,this.upload.onprogress(e)},10)),this.onprogress&&(this._progressTimer=setTimeout(t=>{this._progressTimer=null;const e=new Event("progress");e.loaded=500,e.total=1e3,this.onprogress(e)},10)),this._completeTimer=setTimeout(t=>{if(this._completeTimer=null,this.forceError){if(this.onerror){const t=new Event("error");this.onerror(t)}}else if(this.data.status=this.status,this.response=this._response,this.onload){const t=new Event("load");this.onload(t)}},20)}setRequestHeader(t,e){this.data.headers[t]=e}}Object.assign(o.prototype,{_build(){this._xhr=this.constructor.useMock?new r:new XMLHttpRequest,this._xhr.open(this._options.method,this._options.url,!0,this._options.username,this._options.password);for(const t in this._options.headers)this._xhr.setRequestHeader(t,this._options.headers[t]);this._options.responseType&&(this._xhr.responseType=this._options.responseType),this._options.mimeType&&this._xhr.overrideMimeType(this._options.mimeType),this._options.timeout&&(this._xhr.timeout=this._options.timeout)},_events(){this._xhr.onload=t=>{this._xhr.status>400?this._reject({status:this._xhr.status,xhr:this._xhr,event:t}):this._resolve({response:this._xhr.response,xhr:this._xhr,event:t})},this._isLocal||(this._xhr.onerror=t=>this._reject({status:this._xhr.status,xhr:this._xhr,event:t})),this._options.onProgress&&(this._xhr.onprogress=t=>this._options.onProgress(t.loaded/t.total,this._xhr,t)),this._options.onUploadProgress&&(this._xhr.upload.onprogress=t=>this._options.onUploadProgress(t.loaded/t.total,this._xhr,t))},_send(){this._options.beforeSend&&this._options.beforeSend(this._xhr),this._options.data&&this._options.processData&&e.isObject(this._options.data)&&("application/json"===this._options.contentType?this._options.data=JSON.stringify(this._options.data):"application/x-www-form-urlencoded"===this._options.contentType?this._options.data=this.constructor._parseParams(this._options.data):this._options.data=this.constructor._parseFormData(this._options.data)),this._xhr.send(this._options.data),this._options.afterSend&&this._options.afterSend(this._xhr)}}),Object.assign(o,{appendQueryString(e,s,o){const r=(t.location.origin+t.location.pathname).replace(/\/$/,""),n=new URL(e,r);n.searchParams.append(s,o);let i=n.toString();if(i.substring(0,e.length)===e)return i;const a=i.indexOf(e);return i.substring(a)},_parseFormData(t){const e=this._parseValues(t),s=new FormData;for(const[t,o]of e)"[]"===t.substring(t.length-2)?s.append(t,o):s.set(t,o);return s},_parseParams(t){const e=this._parseValues(t).map(([t,e])=>`${t}=${e}`).join("&");return encodeURI(e)},_parseValue(t,s){if(e.isArray(s)){"[]"!==t.substring(t.length-2)&&(t+="[]");const e=[];for(const o of s)e.push(...this._parseValue(t,o));return e}if(e.isObject(s)){const e=[];for(const o in s)e.push(...this._parseValue(`${t}[${o}]`,s[o]));return e}return[[t,s]]},_parseValues(t){const s=[];if(e.isArray(t))for(const e of t)s.push(...this._parseValue(e.name,e.value));else if(e.isObject(t))for(const e in t)s.push(...this._parseValue(e,t[e]));return s}}),Object.assign(o,{defaults:{afterSend:null,beforeSend:null,cache:!0,contentType:"application/x-www-form-urlencoded",data:null,headers:{},isLocal:null,method:"GET",onProgress:null,onUploadProgress:null,processData:!0,rejectOnCancel:!0,responseType:null,url:null},useMock:!1,_localRegExp:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/}),Object.setPrototypeOf(o.prototype,Promise.prototype);class n{constructor(t,e,s){this._node=t,this._callback=e,this._options={...this.constructor.defaults,...s},"start"in this._options||(this._options.start=performance.now()),this._options.debug&&(this._node.dataset.animationStart=this._options.start),this.promise=new Promise((t,e)=>{this._resolve=t,this._reject=e}),this.constructor._animations.has(t)?this.constructor._animations.get(t).push(this):this.constructor._animations.set(t,[this])}catch(t){return this.promise.catch(t)}finally(t){return this.promise.finally(t)}then(t,e){return this.promise.then(t,e)}update(t=!1,s=!1){if(t&&!s)return this._reject(this._node),!0;const o=performance.now();let r;return s?r=1:(r=(o-this._options.start)/this._options.duration,this._options.infinite?r%=1:r=e.clamp(r),"ease-in"===this._options.type?r=r**2:"ease-out"===this._options.type?r=Math.sqrt(r):"ease-in-out"===this._options.type&&(r=r<=.5?r**2*2:1-(1-r)**2*2)),this._options.debug&&(this._node.dataset.animationNow=o,this._node.dataset.animationProgress=r),this._callback(this._node,r,this._options),r<1?void 0:(this._options.debug&&(delete this._node.dataset.animationStart,delete this._node.dataset.animationNow,delete this._node.dataset.animationProgress),this._resolve(this._node),!0)}}Object.assign(n,{start(){this._animating||(this._animating=!0,this.update())},stop(t,e=!0){if(!this._animations.has(t))return;const s=this._animations.get(t);for(const t of s)t.update(!0,e);this._animations.delete(t)},update(){for(let[t,e]of this._animations)e=e.filter(t=>!t.update()),e.length?this._animations.set(t,e):this._animations.delete(t);this._animations.size?this.useTimeout?setTimeout(t=>this.update(),1e3/60):t.requestAnimationFrame(t=>this.update()):this._animating=!1}}),Object.assign(n,{defaults:{duration:1e3,type:"ease-in-out",infinite:!1,debug:!1},useTimeout:!1,_animating:!1,_animations:new Map}),Object.setPrototypeOf(n.prototype,Promise.prototype);class i{constructor(t=s){this._context=t}}return Object.assign(i.prototype,{ajax:t=>new o(t),delete:(t,e)=>new o({url:t,method:"DELETE",...e}),get:(t,e,s)=>new o({url:t,data:e,...s}),patch:(t,e,s)=>new o({url:t,data:e,method:"PATCH",...s}),post:(t,e,s)=>new o({url:t,data:e,method:"POST",...s}),put:(t,e,s)=>new o({url:t,data:e,method:"PUT",...s})}),Object.assign(i.prototype,{loadScript(t,e,s=!0){return e={src:t,type:"text/javascript",...e},s||(e.src=o.appendQueryString(e.src,"_",Date.now())),new Promise((t,s)=>{const o=this.create("script",{attributes:e});o.onload=e=>t(),o.onerror=t=>s(),this._context.head.appendChild(o)})},loadScripts(t,s=!0){return Promise.all(t.map(t=>e.isString(t)?this.loadScript(t,null,s):this.loadScript(null,t,s)))}}),Object.assign(i.prototype,{loadStyle(t,e,s=!0){return e={href:t,rel:"stylesheet",...e},s||(e.href=o.appendQueryString(e.href,"_",Date.now())),new Promise((t,s)=>{const o=this.create("link",{attributes:e});o.onload=e=>t(),o.onerror=t=>s(),this._context.head.appendChild(o)})},loadStyles(t,s=!0){return Promise.all(t.map(t=>e.isString(t)?this.loadStyle(t,null,s):this.loadStyle(null,t,s)))}}),Object.assign(i.prototype,{animate(t,e,s){const o=(t=this.parseNodes(t)).map(t=>new n(t,e,s));return n.start(),Promise.all(o)},stop(t,e=!0){t=this.parseNodes(t);for(const s of t)n.stop(s,e)}}),Object.assign(i.prototype,{dropIn(t,e){return this.slideIn(t,{direction:"top",...e})},dropOut(t,e){return this.slideOut(t,{direction:"top",...e})},fadeIn(t,e){return this.animate(t,(t,e)=>t.style.setProperty("opacity",e<1?e.toFixed(2):""),e)},fadeOut(t,e){return this.animate(t,(t,e)=>t.style.setProperty("opacity",e<1?(1-e).toFixed(2):""),e)},rotateIn(t,e){return this.animate(t,(t,e,s)=>{const o=((90-90*e)*(s.inverse?-1:1)).toFixed(2);t.style.setProperty("transform",e<1?`rotate3d(${s.x}, ${s.y}, ${s.z}, ${o}deg)`:"")},{x:0,y:1,z:0,...e})},rotateOut(t,e){return this.animate(t,(t,e,s)=>{const o=(90*e*(s.inverse?-1:1)).toFixed(2);t.style.setProperty("transform",e<1?`rotate3d(${s.x}, ${s.y}, ${s.z}, ${o}deg)`:"")},{x:0,y:1,z:0,...e})},slideIn(t,s){return this.animate(t,(t,s,o)=>{if(1===s)return t.style.setProperty("overflow",""),void(o.useGpu?t.style.setProperty("transform",""):(t.style.setProperty("margin-left",""),t.style.setProperty("margin-top","")));const r=e.evaluate(o.direction);let n,i,a;["top","bottom"].includes(r)?(n=o.useGpu?"Y":"margin-top",i=this.constructor._height(t),a="top"===r):(n=o.useGpu?"X":"margin-left",i=this.constructor._width(t),a="left"===r);const c=((i-i*s)*(a?-1:1)).toFixed(2);o.useGpu?t.style.setProperty("transform",`translate${n}(${c}px)`):t.style.setProperty(n,c+"px")},{direction:"bottom",useGpu:!0,...s})},slideOut(t,s){return this.animate(t,(t,s,o)=>{if(1===s)return t.style.setProperty("overflow",""),void(o.useGpu?t.style.setProperty("transform",""):(t.style.setProperty("margin-left",""),t.style.setProperty("margin-top","")));const r=e.evaluate(o.direction);let n,i,a;["top","bottom"].includes(r)?(n=o.useGpu?"Y":"margin-top",i=this.constructor._height(t),a="top"===r):(n=o.useGpu?"X":"margin-left",i=this.constructor._width(t),a="left"===r);const c=(i*s*(a?-1:1)).toFixed(2);o.useGpu?t.style.setProperty("transform",`translate${n}(${c}px)`):t.style.setProperty(n,c+"px")},{direction:"bottom",useGpu:!0,...s})},squeezeIn(t,s){t=this.parseNodes(t),s={direction:"bottom",useGpu:!0,...s};const o=t.map(t=>{const o=t.style.height,r=t.style.width;return t.style.setProperty("overflow","hidden"),new n(t,(t,s,n)=>{if(t.style.setProperty("height",o),t.style.setProperty("width",r),1===s)return t.style.setProperty("overflow",""),void(n.useGpu?t.style.setProperty("transform",""):(t.style.setProperty("margin-left",""),t.style.setProperty("margin-top","")));const a=e.evaluate(n.direction);let c,h;["top","bottom"].includes(a)?(c="height","top"===a&&(h=n.useGpu?"Y":"margin-top")):(c="width","left"===a&&(h=n.useGpu?"X":"margin-left"));const l=i["_"+c](t),d=(l*s).toFixed(2);if(t.style.setProperty(c,d+"px"),h){const e=(l-d).toFixed(2);n.useGpu?t.style.setProperty("transform",`translate${h}(${e}px)`):t.style.setProperty(h,e+"px")}},s)});return n.start(),Promise.all(o)},squeezeOut(t,s){t=this.parseNodes(t),s={direction:"bottom",useGpu:!0,...s};const o=t.map(t=>{const o=t.style.height,r=t.style.width;return t.style.setProperty("overflow","hidden"),new n(t,(t,s,n)=>{if(t.style.setProperty("height",o),t.style.setProperty("width",r),1===s)return t.style.setProperty("overflow",""),void(n.useGpu?t.style.setProperty("transform",""):(t.style.setProperty("margin-left",""),t.style.setProperty("margin-top","")));const a=e.evaluate(n.direction);let c,h;["top","bottom"].includes(a)?(c="height","top"===a&&(h=n.useGpu?"Y":"margin-top")):(c="width","left"===a&&(h=n.useGpu?"X":"margin-left"));const l=i["_"+c](t),d=(l-l*s).toFixed(2);if(t.style.setProperty(c,d+"px"),h){const e=(l-d).toFixed(2);n.useGpu?t.style.setProperty("transform",`translate${h}(${e}px)`):t.style.setProperty(h,e+"px")}},s)});return n.start(),Promise.all(o)}}),Object.assign(i.prototype,{clearQueue(t){t=this.parseNodes(t);for(const e of t)this.constructor._clearQueue(e)},queue(t,e){t=this.parseNodes(t);for(const s of t)this.constructor._queue(s,e)}}),Object.assign(i.prototype,{getAttribute(t,e){const s=this.parseNode(t);if(s)return this.constructor._getAttribute(s,e)},getDataset(t,e){const s=this.parseNode(t);if(s)return this.constructor._getDataset(s,e)},getHTML(t){return this.getProperty(t,"innerHTML")},getProperty(t,e){const s=this.parseNode(t);if(s)return s[e]},getText(t){return this.getProperty(t,"innerText")},getValue(t){return this.getProperty(t,"value")},removeAttribute(t,e){t=this.parseNodes(t);for(const s of t)s.removeAttribute(e)},removeDataset(t,e){t=this.parseNodes(t);for(const s of t)this.constructor._removeDataset(s,e)},removeProperty(t,e){t=this.parseNodes(t);for(const s of t)delete s[e]},setAttribute(t,e,s){t=this.parseNodes(t);const o=this.constructor._parseData(e,s);for(const e of t)this.constructor._setAttribute(e,o)},setDataset(t,e,s){t=this.parseNodes(t);const o=this.constructor._parseData(e,s,!0);for(const e of t)this.constructor._setDataset(e,o)},setHTML(t,e){this.empty(t),this.setProperty(t,"innerHTML",e)},setProperty(t,e,s){t=this.parseNodes(t);const o=this.constructor._parseData(e,s);for(const e of t)for(const t in o)e[t]=o[t]},setText(t,e){this.empty(t),this.setProperty(t,"innerText",e)},setValue(t,e){this.setProperty(t,"value",e)}}),Object.assign(i.prototype,{cloneData(t,e){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0,window:!0}),e=this.parseNodes(e,{fragment:!0,shadow:!0,document:!0,window:!0});for(const s of t)for(const t of e)this.constructor._cloneData(s,t)},getData(t,e){const s=this.parseNode(t,{fragment:!0,shadow:!0,document:!0,window:!0});if(s)return this.constructor._getData(s,e)},removeData(t,e){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0,window:!0});for(const s of t)this.constructor._removeData(s,e)},setData(t,e,s){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0,window:!0});const o=this.constructor._parseData(e,s);for(const e of t)this.constructor._setData(e,o)}}),Object.assign(i.prototype,{center(t,e){const s=this.rect(t,e);if(s)return{x:s.left+s.width/2,y:s.top+s.height/2}},constrain(t,e){const s=this.rect(e);if(s){t=this.parseNodes(t);for(const e of t)this.constructor._constrain(e,s)}},distTo(t,s,o,r){const n=this.center(t,r);if(n)return e.dist(n.x,n.y,s,o)},distToNode(t,e){const s=this.center(e);if(s)return this.distTo(t,s.x,s.y)},nearestTo(t,e,s,o){let r,n=Number.MAX_VALUE;t=this.parseNodes(t);for(const i of t){const t=this.distTo(i,e,s,o);t&&t<n&&(n=t,r=i)}return r},nearestToNode(t,e){const s=this.center(e);if(s)return this.nearestTo(t,s.x,s.y)},percentX(t,s,o,r=!0){const n=this.rect(t,o);if(!n)return;const i=(s-n.left)/n.width*100;return r?e.clampPercent(i):i},percentY(t,s,o,r=!0){const n=this.rect(t,o);if(!n)return;const i=(s-n.top)/n.height*100;return r?e.clampPercent(i):i},position(t,e){const s=this.parseNode(t);if(s)return this.constructor._position(s,e)},rect(t,e){const s=this.parseNode(t);if(s)return this.constructor._rect(s,e)}}),Object.assign(i.prototype,{getScrollX(t){const s=this.parseNode(t,{document:!0,window:!0});if(s)return e.isWindow(s)?s.scrollX:e.isDocument(s)?this.constructor._getScrollXDocument(s):s.scrollLeft},getScrollY(t){const s=this.parseNode(t,{document:!0,window:!0});if(s)return e.isWindow(s)?s.scrollY:e.isDocument(s)?this.constructor._getScrollYDocument(s):s.scrollTop},setScroll(t,s,o){t=this.parseNodes(t,{document:!0,window:!0});for(const r of t)e.isWindow(r)?r.scroll(s,o):e.isDocument(r)?this.constructor._setScrollDocument(r,s,o):this.constructor._setScroll(r,s,o)},setScrollX(t,s){t=this.parseNodes(t,{document:!0,window:!0});for(const o of t)e.isWindow(o)?this.constructor._setScrollXWindow(o,s):e.isDocument(o)?this.constructor._setScrollXDocument(o,s):o.scrollLeft=s},setScrollY(t,s){t=this.parseNodes(t,{document:!0,window:!0});for(const o of t)e.isWindow(o)?this.constructor._setScrollYWindow(o,s):e.isDocument(o)?this.constructor._setScrollYDocument(o,s):o.scrollTop=s}}),Object.assign(i.prototype,{height(t,s){const o=this.parseNode(t,{document:!0,window:!0});if(o)return e.isWindow(o)?s?o.outerHeight:o.innerHeight:(e.isUndefined(s)&&(s=1),this.constructor._height(o,s))},scrollHeight(t){const e=this.parseNode(t,{document:!0});if(e)return this.constructor._scrollHeight(e)},scrollWidth(t){const e=this.parseNode(t,{document:!0});if(e)return this.constructor._scrollWidth(e)},width(t,s){const o=this.parseNode(t,{document:!0,window:!0});if(o)return e.isWindow(o)?s?o.outerWidth:o.innerWidth:(e.isUndefined(s)&&(s=1),this.constructor._width(o,s))}}),Object.assign(i.prototype,{addClass(t,...e){if(t=this.parseNodes(t),(e=this.constructor._parseClasses(e)).length)for(const s of t)s.classList.add(...e)},css(t,e){const s=this.parseNode(t);if(s)return this.constructor._css(s,e)},getStyle(t,e){const s=this.parseNode(t);if(s)return this.constructor._getStyle(s,e)},hide(t){this.setStyle(t,"display","none")},removeClass(t,...e){if(t=this.parseNodes(t),(e=this.constructor._parseClasses(e)).length)for(const s of t)s.classList.remove(...e)},setStyle(t,e,s,o){t=this.parseNodes(t);const r=this.constructor._parseData(e,s);for(const e of t)this.constructor._setStyle(e,r,o)},show(t){this.setStyle(t,"display","")},toggle(t){t=this.parseNodes(t);for(const e of t)e.style.setProperty("display","none"===e.style.display?"":"none")},toggleClass(t,...e){if(t=this.parseNodes(t),(e=this.constructor._parseClasses(e)).length)for(const s of t)for(const t of e)s.classList.toggle(t)}}),Object.assign(i.prototype,{getCookie(t){const e=this._context.cookie.split(";").find(e=>e.trimStart().substring(0,t.length)===t).trimStart();return e?decodeURIComponent(e.substring(t.length+1)):null},removeCookie(t,e){if(!t)return;let s=t+"=;expires=Thu, 01 Jan 1970 00:00:00 UTC";e&&(e.path&&(s+=";path="+e.path),e.secure&&(s+=";secure")),this._context.cookie=s},setCookie(t,e,s){if(!t)return;let o=`${t}=${e}`;if(s){if(s.expires){const t=new Date;t.setTime(t.getTime()+1e3*s.expires),o+=";expires="+t.toUTCString()}s.path&&(o+=";path="+s.path),s.secure&&(o+=";secure")}this._context.cookie=o}}),Object.assign(i.prototype,{mouseDragFactory(s,o,r,n=!0){return o&&n&&(o=e.animation(o),r&&(r=e.animation(r))),e=>{if(s&&!1===s(e))return!1;o&&this.addEvent(t,"mousemove",o),(o||r)&&this.addEventOnce(t,"mouseup",e=>{o&&this.removeEvent(t,"mousemove",o),r&&r(e)})}}}),Object.assign(i.prototype,{blur(t){const e=this.parseNode(t);e&&e.blur()},click(t){const e=this.parseNode(t);e&&e.click()},focus(t){const e=this.parseNode(t);e&&e.focus()},ready(e){"complete"!==this._context.readyState?this.constructor._addEvent(t,"DOMContentLoaded",e):e()}}),Object.assign(i.prototype,{addEvent(t,e,s,o,r){t=this.parseNodes(t,{shadow:!0,document:!0,window:!o});for(const n of t)for(const t of this.constructor._parseEvents(e))this.constructor._addEvent(n,t,s,o,r)},addEventDelegate(t,e,s,o){this.addEvent(t,e,o,s)},addEventDelegateOnce(t,e,s,o){this.addEvent(t,e,o,s,!0)},addEventOnce(t,e,s){this.addEvent(t,e,s,null,!0)},cloneEvents(t,e){t=this.parseNodes(t,{shadow:!0,document:!0,window:!0}),e=this.parseNodes(e,{shadow:!0,document:!0,window:!0});for(const s of t)for(const t of e)this.constructor._cloneEvents(s,t)},removeEvent(t,e,s,o){t=this.parseNodes(t,{shadow:!0,document:!0,window:!o}),e=!!e&&this.constructor._parseEvents(e);for(const r of t)if(this.constructor._events.has(r))if(e)for(const t of e)this.constructor._removeEvent(r,t,s,o);else this.constructor._removeEvent(r,e,s,o)},removeEventDelegate(t,e,s,o){this.removeEvent(t,e,o,s)},triggerEvent(t,e,s){t=this.parseNodes(t,{shadow:!0,document:!0,window:!0}),e=this.constructor._parseEvents(e);for(const o of t)for(const t of e)this.constructor._triggerEvent(o,t,s)},triggerOne(t,e,s){const o=this.parseNode(t,{shadow:!0,document:!0,window:!0});return this.constructor._triggerEvent(o,e,s)}}),Object.assign(i.prototype,{attachShadow(t,e=!0){const s=this.parseNode(t);if(s)return s.attachShadow({mode:e?"open":"closed"})},create(t="div",s){const o=this._context.createElement(t);if(!s)return o;if("html"in s?o.innerHTML=s.html:"text"in s&&(o.innerText=s.text),"class"in s&&o.classList.add(...this.constructor._parseClasses(e.wrap(s.class))),"style"in s&&this.constructor._setStyle(o,s.style),"value"in s&&(o.value=s.value),"attributes"in s&&this.constructor._setAttribute(o,s.attributes),"properties"in s)for(const t in s.properties)o[t]=s.properties[t];if("dataset"in s){const t=this.constructor._parseData(s.dataset,null,!0);this.constructor._setDataset(o,t)}return o},createComment(t){return this._context.createComment(t)},createFragment(){return this._context.createDocumentFragment()},createRange(){return this._context.createRange()},createText(t){return this._context.createTextNode(t)},parseHTML(t){return e.wrap(this.createRange().createContextualFragment(t).children)}}),Object.assign(i.prototype,{clone(t,e){return e={deep:!0,...e},(t=this.parseNodes(t,{node:!0,fragment:!0})).map(t=>this.constructor._clone(t,e))},detach(t){t=this.parseNodes(t,{node:!0});for(const e of t){const t=e.parentNode;t&&t.removeChild(e)}return t},empty(t){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0});for(const e of t)this.constructor._empty(e)},remove(t){t=this.parseNodes(t,{node:!0});for(const e of t){const t=e.parentNode;t&&(this.constructor._remove(e),t.removeChild(e))}},replaceAll(t,e){this.replaceWith(e,t)},replaceWith(t,s){t=this.parseNodes(t,{node:!0}),s=this.parseNodes(s,{node:!0,fragment:!0,html:!0});const o=this.createFragment();for(const t of s)o.insertBefore(t,null);s=e.wrap(o.childNodes);const r=(t=t.filter(e=>!s.includes(e)&&!t.some(t=>!t.isSameNode(e)&&t.contains(e))))[t.length-1];for(const e of t){const t=e.parentNode;if(t)for(const o of s)t.insertBefore(e.isSameNode(r)?o:this.constructor._clone(o,{deep:!0,events:!0,data:!0,animations:!0}),e)}for(const e of t){const t=e.parentNode;t&&(this.constructor._remove(e),t.removeChild(e))}}}),Object.assign(i.prototype,{after(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseNodes(e,{node:!0,fragment:!0,html:!0}).reverse();const s=t[t.length-1];for(const o of t){const t=o.parentNode;if(t)for(const r of e)t.insertBefore(o.isSameNode(s)?r:this.constructor._clone(r,{deep:!0,events:!0,data:!0,animations:!0}),o.nextSibling)}},append(t,e){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}),e=this.parseNodes(e,{node:!0,fragment:!0,html:!0});const s=t[t.length-1];for(const o of t)for(const t of e)o.insertBefore(o.isSameNode(s)?t:this.constructor._clone(t,{deep:!0,events:!0,data:!0,animations:!0}),null)},appendTo(t,e){this.append(e,t)},before(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseNodes(e,{node:!0,fragment:!0,html:!0});const s=t[t.length-1];for(const o of t){const t=o.parentNode;if(t)for(const r of e)t.insertBefore(o.isSameNode(s)?r:this.constructor._clone(r,{deep:!0,events:!0,data:!0,animations:!0}),o)}},insertAfter(t,e){this.after(e,t)},insertBefore(t,e){this.before(e,t)},prepend(t,e){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}),e=this.parseNodes(e,{node:!0,fragment:!0,html:!0});const s=t[t.length-1];for(const o of t){const t=o.firstChild;for(const r of e)o.insertBefore(o.isSameNode(s)?r:this.constructor._clone(r,{deep:!0,events:!0,data:!0,animations:!0}),t)}},prependTo(t,e){this.prepend(e,t)}}),Object.assign(i.prototype,{unwrap(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseFilter(e);const s=[];for(const o of t){const t=o.parentNode;t&&(s.includes(t)||e&&!e(t)||s.push(t))}for(const t of s)this.constructor._unwrap(t)},wrap(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseNodes(e,{fragment:!0,html:!0});for(const s of t)this.constructor._wrap(s,e)},wrapAll(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseNodes(e,{fragment:!0,html:!0});const s=this.clone(e,{events:!0,data:!0,animations:!0});this.constructor._wrapAll(t,s)},wrapInner(t,e){t=this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}),e=this.parseNodes(e,{fragment:!0,html:!0});for(const s of t)this.constructor._wrapInner(s,e)}}),Object.assign(i.prototype,{connected(t){return this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter(t=>t.isConnected)},equal(t,e){return e=this.parseNodes(e,{node:!0,fragment:!0,shadow:!0}),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter(t=>e.some(e=>t.isEqualNode(e)))},filter(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter((t,s)=>!e||e(t,s))},filterOne(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).find((t,s)=>!e||e(t,s))||null},fixed(t){return this.parseNodes(t,{node:!0}).filter(t=>e.isElement(t)&&"fixed"===this.constructor._css(t,"position")||this.constructor._parents(t,t=>e.isElement(t)&&"fixed"===this.constructor._css(t,"position"),!1,!0).length)},hidden(t){return this.parseNodes(t,{node:!0,document:!0,window:!0}).filter(t=>!this.constructor._isVisible(t))},not(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter((t,s)=>e&&!e(t,s))},notOne(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).find((t,s)=>e&&!e(t,s))||null},same(t,e){return e=this.parseNodes(e,{node:!0,fragment:!0,shadow:!0}),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter(t=>e.some(e=>t.isSameNode(e)))},visible(t){return this.parseNodes(t,{node:!0,document:!0,window:!0}).filter(t=>this.constructor._isVisible(t))},withAnimation(t){return this.parseNodes(t).filter(t=>this.constructor._hasAnimation(t))},withAttribute(t,e){return this.parseNodes(t).filter(t=>t.hasAttribute(e))},withChildren(t){return this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}).filter(t=>!!t.childElementCount)},withClass(t,...e){return e=this.constructor._parseClasses(e),this.parseNodes(t).filter(t=>e.some(e=>t.classList.contains(e)))},withCSSAnimation(t){return this.parseNodes(t).filter(t=>this.constructor._hasCSSAnimation(t))},withCSSTransition(t){return this.parseNodes(t).filter(t=>this.constructor._hasCSSTransition(t))},withData(t,e){return this.parseNodes(t,{node:!0,fragment:!0,shadow:!0,document:!0,window:!0}).filter(t=>this.constructor._hasData(t,e))},withDescendent(t,e){return e=this.parseFilterContains(e),this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}).filter((t,s)=>!e||e(t,s))},withProperty(t,e){return this.parseNodes(t).filter(t=>t.hasOwnProperty(e))}}),Object.assign(i.prototype,{find(t,s=this._context){const o=t.match(this.constructor._fastRegExp);return o?"#"===o[1]?this.findById(o[2],s):"."===o[1]?this.findByClass(o[2],s):this.findByTag(o[2],s):(t.match(this.constructor._complexRegExp)&&(t=this.constructor._prefixSelectors(t,":scope ")),e.isDocument(s)||e.isElement(s)||e.isFragment(s)||e.isShadow(s)?e.wrap(s.querySelectorAll(t)):(s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0}),this.constructor._findBySelector(t,s)))},findByClass(t,s=this._context){if(e.isDocument(s)||e.isElement(s))return e.wrap(s.getElementsByClassName(t));if(e.isFragment(s)||e.isShadow(s))return e.wrap(s.querySelectorAll("."+t));s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0});const o=[];for(const r of s)e.merge(o,e.isFragment(r)||e.isShadow(r)?r.querySelectorAll("."+t):r.getElementsByClassName(t));return s.length>1&&o.length>1?e.unique(o):o},findById(t,e=this._context){return e=this.parseNodes(e,{fragment:!0,shadow:!0,document:!0}),this.constructor._findBySelector("#"+t,e)},findByTag(t,s=this._context){if(e.isDocument(s)||e.isElement(s))return e.wrap(s.getElementsByTagName(t));if(e.isFragment(s)||e.isShadow(s))return e.wrap(s.querySelectorAll(t));s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0});const o=[];for(const r of s)e.merge(o,e.isFragment(r)||e.isShadow(r)?r.querySelectorAll(t):r.getElementsByTagName(t));return s.length>1&&o.length>1?e.unique(o):o},findOne(t,s=this._context){const o=t.match(this.constructor._fastRegExp);return o?"#"===o[1]?this.findOneById(o[2],s):"."===o[1]?this.findOneByClass(o[2],s):this.findOneByTag(o[2],s):(t.match(this.constructor._complexRegExp)&&(t=this.constructor._prefixSelectors(t,":scope ")),e.isDocument(s)||e.isElement(s)||e.isFragment(s)||e.isShadow(s)?s.querySelector(t):(s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0})).length?this.constructor._findOneBySelector(t,s):void 0)},findOneByClass(t,s=this._context){if(e.isDocument(s)||e.isElement(s))return s.getElementsByClassName(t).item(0);if(e.isFragment(s)||e.isShadow(s))return s.querySelector("."+t);if((s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0})).length){for(const o of s){const s=e.isFragment(o)||e.isShadow(o)?o.querySelector("."+t):o.getElementsByClassName(t).item(0);if(s)return s}return null}},findOneById(t,s=this._context){return e.isDocument(s)?s.getElementById(t):(s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0})).length?this.constructor._findOneBySelector("#"+t,s):void 0},findOneByTag(t,s=this._context){if(e.isDocument(s)||e.isElement(s))return s.getElementsByTagName(t).item(0);if(e.isFragment(s)||e.isShadow(s))return s.querySelector(t);if((s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0})).length){for(const o of s){const s=e.isFragment(o)||e.isShadow(o)?o.querySelector(t):o.getElementsByTagName(t).item(0);if(s)return s}return null}}}),Object.assign(i.prototype,{child(t,e){return this.children(t,e,!0)},children(t,s,o=!1,r=!0){if(s=this.parseFilter(s),e.isElement(t)||e.isDocument(t)||e.isFragment(t)||e.isShadow(t))return this.constructor._children(t,s,o,r);t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0});const n=[];for(const i of t)e.merge(n,this.constructor._children(i,s,o,r));return t.length>1&&n.length>1?e.unique(n):n},closest(t,e,s){return this.parents(t,e,s,!0)},commonAncestor(t){if(!(t=this.sort(t)).length)return;if(t.some(t=>!t.parentNode))return;const e=this.createRange();return 1===t.length?e.selectNode(t.shift()):(e.setStartBefore(t.shift()),e.setEndAfter(t.pop())),e.commonAncestorContainer},contents(t){return this.children(t,!1,!1,!1)},fragment(t){const e=this.parseNode(t);if(e)return e.content},next(t,s){if(s=this.parseFilter(s),e.isNode(t))return this.constructor._next(t,s);t=this.parseNodes(t,{node:!0});const o=[];for(const r of t)e.merge(o,this.constructor._next(r,s));return t.length>1&&o.length>1?e.unique(o):o},nextAll(t,s,o,r=!1){if(s=this.parseFilter(s),o=this.parseFilter(o),e.isNode(t))return this.constructor._nextAll(t,s,o,r);t=this.parseNodes(t,{node:!0});const n=[];for(const i of t)e.merge(n,this.constructor._nextAll(i,s,o,r));return t.length>1&&n.length>1?e.unique(n):n},offsetParent(t){return this.forceShow(t,t=>t.offsetParent)},parent(t,s){if(s=this.parseFilter(s),e.isNode(t))return this.constructor._parent(t,s);t=this.parseNodes(t,{node:!0});const o=[];for(const r of t)e.merge(o,this.constructor._parent(r,s));return t.length>1&&o.length>1?e.unique(o):o},parents(t,s,o,r=!1){if(s=this.parseFilter(s),o=this.parseFilter(o),e.isNode(t))return this.constructor._parents(t,s,o,r);t=this.parseNodes(t,{node:!0});const n=[];for(const i of t)e.merge(n,this.constructor._parents(i,s,o,r));return t.length>1&&n.length>1?e.unique(n):n},prev(t,s){if(s=this.parseFilter(s),e.isNode(t))return this.constructor._prev(t,s);t=this.parseNodes(t,{node:!0});const o=[];for(const r of t)e.merge(o,this.constructor._prev(r,s));return t.length>1&&o.length>1?e.unique(o):o},prevAll(t,s,o,r=!1){if(s=this.parseFilter(s),o=this.parseFilter(o),e.isNode(t))return this.constructor._prevAll(t,s,o,r);t=this.parseNodes(t,{node:!0});const n=[];for(const i of t)e.merge(n,this.constructor._prevAll(i,s,o,r));return t.length>1&&n.length>1?e.unique(n):n},shadow(t){const e=this.parseNode(t);if(e)return e.shadowRoot},siblings(t,s,o=!0){if(s=this.parseFilter(s),e.isNode(t))return this.constructor._siblings(t,s,o);t=this.parseNodes(t,{node:!0});const r=[];for(const n of t)e.merge(r,this.constructor._siblings(n,s,o));return t.length>1&&r.length>1?this.sort(e.unique(r)):r}}),Object.assign(i.prototype,{parseFilter(t){return!!t&&(e.isFunction(t)?t:e.isString(t)?s=>e.isElement(s)&&s.matches(t):e.isNode(t)||e.isFragment(t)||e.isShadow(t)?e=>e.isSameNode(t):!!(t=this.parseNodes(t,{node:!0,fragment:!0,shadow:!0})).length&&(e=>t.includes(e)))},parseFilterContains(t){return!!t&&(e.isFunction(t)?s=>e.merge([],s.querySelectorAll("*")).some(t):e.isString(t)?e=>!!this.findOne(t,e):e.isNode(t)||e.isFragment(t)||e.isShadow(t)?e=>e.contains(t):!!(t=this.parseNodes(t,{node:!0,fragment:!0,shadow:!0})).length&&(e=>t.some(t=>e.contains(t))))},parseNode(t,e={}){const s=this.constructor.parseNodesFactory(e);return this.parseNodesDeep(t,s,e.html,!0)},parseNodes(t,e={}){const s=this.constructor.parseNodesFactory(e);return this.parseNodesDeep(t,s,e.html)},parseNodesDeep(s,o,r=!1,n=!1){if(!s)return n?null:[];if(e.isString(s)){if(r&&"<"===s.trim().charAt(0))return this.parseHTML(s);if(!n)return this.find(s,this._context);const t=this.findOne(s,this._context);return t||null}if(o(s))return n?s:[s];if("QuerySet"in t&&s instanceof QuerySet){if(!n)return s.get().filter(o);const t=s.get(0);return t&&o(t)?t:null}if(s instanceof HTMLCollection)return n?s.length?s.item(0):null:e.wrap(s);if(e.isArray(s)){const t=this.constructor.parseNodesFactory({node:!0,fragment:!0,shadow:!0,document:!0,window:!0});s=s.flatMap(e=>this.parseNodesDeep(e,t,r))}else s=e.wrap(s);if(s.length&&(s=e.unique(s)),!n)return s.filter(o);const i=s.shift();return i&&o(i)?i:null}}),Object.assign(i.prototype,{afterSelection(e){e=this.parseNodes(e,{node:!0,fragment:!0,html:!0}).reverse();const s=t.getSelection();if(!s.rangeCount)return;const o=s.getRangeAt(0);s.removeAllRanges(),o.collapse();for(const t of e)o.insertNode(t)},beforeSelection(e){e=this.parseNodes(e,{node:!0,fragment:!0,html:!0}).reverse();const s=t.getSelection();if(!s.rangeCount)return;const o=s.getRangeAt(0);s.removeAllRanges();for(const t of e)o.insertNode(t)},extractSelection(){const s=t.getSelection();if(!s.rangeCount)return[];const o=s.getRangeAt(0);s.removeAllRanges();const r=o.extractContents();return e.wrap(r.childNodes)},getSelection(){const s=t.getSelection();if(!s.rangeCount)return[];const o=s.getRangeAt(0),r=e.wrap(o.commonAncestorContainer.querySelectorAll("*"));if(!r.length)return[o.commonAncestorContainer];if(1===r.length)return r;const n=o.startContainer,i=o.endContainer,a=e.isElement(n)?n:n.parentNode,c=e.isElement(i)?i:i.parentNode,h=r.slice(r.indexOf(a),r.indexOf(c)+1),l=[];let d;for(const t of h)d&&d.contains(t)||(d=t,l.push(t));return l},select(e){const s=this.parseNode(e,{node:!0});if(s&&"select"in s)return s.select();const o=t.getSelection();if(o.rangeCount>0&&o.removeAllRanges(),!s)return;const r=this.createRange();r.selectNode(s),o.addRange(r)},selectAll(e){e=this.sort(e);const s=t.getSelection();if(s.rangeCount&&s.removeAllRanges(),!e.length)return;const o=this.createRange();1==e.length?o.selectNode(e.shift()):(o.setStartBefore(e.shift()),o.setEndAfter(e.pop())),s.addRange(o)},wrapSelection(s){s=this.parseNodes(s,{fragment:!0,html:!0});const o=t.getSelection();if(!o.rangeCount)return;const r=o.getRangeAt(0);o.removeAllRanges();const n=r.extractContents(),i=this.constructor._deepest(s.slice().shift()),a=e.wrap(n.childNodes);for(const t of a)i.insertBefore(t,null);for(const t of s)r.insertNode(t)}}),Object.assign(i.prototype,{hasAnimation(t){return this.parseNodes(t).some(t=>this.constructor._hasAnimation(t))},hasAttribute(t,e){return this.parseNodes(t).some(t=>t.hasAttribute(e))},hasChildren(t){return this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}).some(t=>!!t.childElementCount)},hasClass(t,...e){return e=this.constructor._parseClasses(e),this.parseNodes(t).some(t=>e.some(e=>t.classList.contains(e)))},hasCSSAnimation(t){return this.parseNodes(t).some(t=>this.constructor._hasCSSAnimation(t))},hasCSSTransition(t){return this.parseNodes(t).some(t=>this.constructor._hasCSSTransition(t))},hasData(t,e){return this.parseNodes(t,{fragment:!0,shadow:!0,document:!0,window:!0}).some(t=>this.constructor._hasData(t,e))},hasDescendent(t,e){return e=this.parseFilterContains(e),this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}).some(t=>!e||e(t))},hasFragment(t){return this.parseNodes(t).some(t=>this.constructor._hasFragment(t))},hasProperty(t,e){return this.parseNodes(t).some(t=>t.hasOwnProperty(e))},hasShadow(t){return this.parseNodes(t).some(t=>this.constructor._hasShadow(t))},is(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).some(t=>!e||e(t))},isConnected(t){return this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).some(t=>t.isConnected)},isEqual(t,e){return e=this.parseNodes(e,{node:!0,fragment:!0,shadow:!0}),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).some(t=>e.some(e=>t.isEqualNode(e)))},isFixed(t){return this.parseNodes(t,{node:!0}).some(t=>e.isElement(t)&&"fixed"===this.constructor._css(t,"position")||this.constructor._parents(t,t=>e.isElement(t)&&"fixed"===this.constructor._css(t,"position"),!1,!0).length)},isHidden(t){return this.parseNodes(t,{node:!0,document:!0,window:!0}).some(t=>!this.constructor._isVisible(t))},isSame(t,e){return e=this.parseNodes(e,{node:!0,fragment:!0,shadow:!0}),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).some(t=>e.some(e=>t.isSameNode(e)))},isVisible(t){return this.parseNodes(t,{node:!0,document:!0,window:!0}).some(t=>this.constructor._isVisible(t))}}),Object.assign(i.prototype,{exec(t,e=null){return this._context.execCommand(t,!1,e)},forceShow(t,e){const s=this.parseNode(t,{node:!0});if(s)return this.constructor._forceShow(s,e)},index(t){const s=this.parseNode(t,{node:!0});if(s)return e.wrap(s.parentNode.children).indexOf(s)},indexOf(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).findIndex(t=>!e||e(t))},normalize(t){t=this.parseNodes(t,{node:!0,fragment:!0,shadow:!0,document:!0});for(const e of t)e.normalize()},sanitize(t,e=i.allowedTags){const s=this.create("template",{html:t}),o=s.content,r=this.constructor._children(o,null,!1,!0);for(const t of r)this.constructor._sanitize(t,o,e);return this.getHTML(s)},serialize(t){return o._parseParams(this.serializeArray(t))},serializeArray(t){return this.parseNodes(t,{fragment:!0,shadow:!0}).reduce((t,s)=>{if(e.isElement(s)&&s.matches("form")||e.isFragment(s)||e.isShadow(s))return t.concat(this.serializeArray(s.querySelectorAll("input, select, textarea")));if(e.isElement(s)&&s.matches("[disabled], input[type=submit], input[type=reset], input[type=file], input[type=radio]:not(:checked), input[type=checkbox]:not(:checked)"))return t;const o=s.getAttribute("name");if(!o)return t;if(e.isElement(s)&&s.matches("select[multiple]")){const r=e.wrap(s.selectedOptions);for(const e of r)t.push({name:o,value:e.value||""})}else t.push({name:o,value:s.value||""});return t},[])},sort(t){return t=this.parseNodes(t,{node:!0,fragment:!0,shadow:!0,document:!0,window:!0}),this.constructor._sort(t)},tagName(t){const e=this.parseNode(t);if(e)return this.constructor._tagName(e)}}),Object.assign(i,{_clearQueue(t){this._queues.has(t)&&this._queues.delete(t)},_dequeueNode(t){if(!this._queues.has(t))return;const e=this._queues.get(t).shift();e?Promise.resolve(e(t)).then(e=>this._dequeueNode(t)).catch(e=>this._clearQueue(t)):this._queues.delete(t)},_queue(t,e){const s=!this._queues.has(t);s&&this._queues.set(t,[t=>new Promise(t=>setTimeout(t,0))]),this._queues.get(t).push(e),s&&this._dequeueNode(t)}}),Object.assign(i,{_getAttribute(t,e){if(e)return t.getAttribute(e);const s={};for(const e of t.attributes)s[e.nodeName]=e.nodeValue;return s},_getDataset(t,s){if(s)return s=e.camelCase(s),this._parseDataset(t.dataset[s]);const o={};for(const e in t.dataset)o[e]=this._parseDataset(t.dataset[e]);return o},_removeDataset(t,s){s=e.camelCase(s),delete t.dataset[s]},_setAttribute(t,e){for(const s in e)t.setAttribute(s,e[s])},_setDataset(t,s){for(const o in s){const r=e.camelCase(o);t.dataset[r]=s[o]}}}),Object.assign(i,{_cloneData(t,e){this._data.has(t)&&this._setData(e,{...this._data.get(t)})},_getData(t,e){if(this._data.has(t))return e?this._data.get(t)[e]:this._data.get(t)},_removeData(t,e){if(this._data.has(t)){if(e){const s=this._data.get(t);if(delete s[e],Object.keys(s).length)return}this._data.delete(t)}},_setData(t,e){this._data.has(t)||this._data.set(t,{}),Object.assign(this._data.get(t),e)}}),Object.assign(i,{_constrain(t,e){const s=this._rect(t),o={};let r,n;if(s.height>e.height&&(o.height=e.height),s.width>e.width&&(o.width=e.width),s.left-e.left<0?r=s.left-e.left:s.right-e.right>0&&(r=s.right-e.right),r){const e=this._css(t,"left"),s=e&&"auto"!==e?parseFloat(e):0;o.left=s-r+"px"}if(s.top-e.top<0?n=s.top-e.top:s.bottom-e.bottom>0&&(n=s.bottom-e.bottom),n){const e=this._css(t,"top"),s=e&&"auto"!==e?parseFloat(e):0;o.top=s-n+"px"}"static"===this._css(t,"position")&&(o.position="relative"),this._setStyle(t,o)},_position(t,e){return this._forceShow(t,t=>{const s={x:t.offsetLeft,y:t.offsetTop};if(e){let e=t;for(;e=e.offsetParent;)s.x+=e.offsetLeft,s.y+=e.offsetTop}return s})},_rect(e,s){return this._forceShow(e,e=>{const o=e.getBoundingClientRect();return s&&(o.x+=t.scrollX,o.y+=t.scrollY),o})}}),Object.assign(i,{_getScrollXDocument:t=>t.scrollingElement.scrollLeft,_getScrollYDocument:t=>t.scrollingElement.scrollTop,_setScroll(t,e,s){t.scrollLeft=e,t.scrollTop=s},_setScrollDocument(t,e,s){this._setScroll(t.scrollingElement,e,s)},_setScrollXDocument(t,e){t.scrollingElement.scrollLeft=e},_setScrollXWindow:(t,e)=>t.scroll(e,t.scrollY),_setScrollYDocument(t,e){t.scrollingElement.scrollTop=e},_setScrollYWindow:(t,e)=>t.scroll(t.scrollX,e)}),Object.assign(i,{_height(t,s=1){return this._forceShow(t,t=>{e.isDocument(t)&&(t=t.documentElement);let o=t.clientHeight;return s===this.INNER&&(o-=parseInt(this._css(t,"padding-top"))+parseInt(this._css(t,"padding-bottom"))),s>=this.OUTER&&(o+=parseInt(this._css(t,"border-top-width"))+parseInt(this._css(t,"border-bottom-width"))),s===this.OUTER_MARGIN&&(o+=parseInt(this._css(t,"margin-top"))+parseInt(this._css(t,"margin-bottom"))),o})},_scrollHeight(t){return this._forceShow(t,t=>(e.isDocument(t)&&(t=t.documentElement),t.scrollHeight))},_scrollWidth(t){return this._forceShow(t,t=>(e.isDocument(t)&&(t=t.documentElement),t.scrollWidth))},_width(t,s=1){return this._forceShow(t,t=>{e.isDocument(t)&&(t=t.documentElement);let o=t.clientWidth;return s===this.INNER&&(o-=parseInt(this._css(t,"padding-left"))+parseInt(this._css(t,"padding-right"))),s>=this.OUTER&&(o+=parseInt(this._css(t,"border-left-width"))+parseInt(this._css(t,"border-right-width"))),s===this.OUTER_MARGIN&&(o+=parseInt(this._css(t,"margin-left"))+parseInt(this._css(t,"margin-right"))),o})}}),Object.assign(i,{_css(s,o){return this._styles.has(s)||this._styles.set(s,t.getComputedStyle(s)),o?(o=e.kebabCase(o),this._styles.get(s).getPropertyValue(o)):{...this._styles.get(s)}},_getStyle(t,s){if(s)return s=e.kebabCase(s),t.style[s];const o={};for(const e of t.style)o[e]=t.style[e];return o},_setStyle(t,s,o){for(let r in s){let n=s[r];r=e.kebabCase(r),n&&e.isNumeric(n)&&!this.cssNumberProperties.includes(r)&&(n+="px"),t.style.setProperty(r,n,o?"important":"")}}}),Object.assign(i,{_delegateFactory(t,s,o){const r=s.match(this._complexRegExp)?this._getDelegateContainsFactory(t,s):this._getDelegateMatchFactory(t,s);return s=>{if(t.isSameNode(s.target))return;const n=r(s.target);if(!n)return;const i={};for(const t in s)i[t]=e.isFunction(s[t])?(...e)=>s[t](...e):s[t];return i.currentTarget=n,i.delegateTarget=t,i.originalEvent=s,Object.freeze(i),o(i)}},_getDelegateContainsFactory(t,s){return s=this._prefixSelectors(s,":scope "),o=>{const r=e.wrap(t.querySelectorAll(s));return!!r.length&&(r.includes(o)?o:this._parents(o,t=>r.includes(t),e=>e.isSameNode(t),!0).shift())}},_getDelegateMatchFactory(t,e){return s=>s.matches(e)?s:this._parents(s,t=>t.matches(e),e=>e.isSameNode(t),!0).shift()},_namespaceFactory:(t,e)=>s=>{if(!("namespaceRegExp"in s)||s.namespaceRegExp.test(t))return e(s)},_selfDestructFactory(t,e,s,o){return r=>(s?this._removeEvent(t,e,o,s):this._removeEvent(t,e,o),o(r))}}),Object.assign(i,{_addEvent(t,e,s,o,r){this._events.has(t)||this._events.set(t,{});const n=this._events.get(t),i={delegate:o,callback:s,selfDestruct:r},a=this._parseEvent(e);let c=s;if(r&&(c=this._selfDestructFactory(t,e,o,c)),o&&(c=this._delegateFactory(t,o,c)),c=this._namespaceFactory(e,c),i.realCallback=c,i.event=e,i.realEvent=a,n[a]){if(n[a].includes(i))return}else n[a]=[];n[a].push(i),t.addEventListener(a,c)},_cloneEvents(t,e){if(!this._events.has(t))return;const s=this._events.get(t);for(const t in s)for(const o of s[t])this._addEvent(e,o.event,o.callback,o.delegate,o.selfDestruct)},_removeEvent(t,e,s,o){if(!this._events.has(t))return;const r=this._events.get(t);if(!e){const e=Object.keys(r);for(const r of e)this._removeEvent(t,r,s,o);return}const n=this._parseEvent(e);r[n]&&(r[n]=r[n].filter(r=>{if(o&&o!==r.delegate||s&&s!==r.callback)return!0;if(n!==e){const t=this._eventNamespacedRegExp(e);if(!r.event.match(t))return!0}return t.removeEventListener(r.realEvent,r.realCallback),!1}),r[n].length||delete r[n],Object.keys(r).length||this._events.delete(t))},_triggerEvent(t,e,s){const o=this._parseEvent(e),r=new CustomEvent(o,{bubbles:!0,cancelable:!0,...s});return o!==e&&(r.namespace=e.substring(o.length+1),r.namespaceRegExp=this._eventNamespacedRegExp(e)),t.dispatchEvent(r)}}),Object.assign(i,{_eventNamespacedRegExp:t=>new RegExp(`^${e.escapeRegExp(t)}(?:\\.|$)`,"i"),_parseClasses:t=>t.flat().flatMap(t=>t.split(" ")),_parseData(t,s,o=!1){const r=e.isObject(t)?t:{[t]:s},n={};for(const t in r){const s=r[t];n[t]=o&&(e.isObject(s)||e.isArray(s))?JSON.stringify(s):s}return n},_parseDataset(t){if(e.isUndefined(t))return t;const s=t.toLowerCase().trim();if(["true","on"].includes(s))return!0;if(["false","off"].includes(s))return!1;if("null"===s)return null;if(e.isNumeric(s))return parseFloat(s);if(["{","["].includes(s.charAt(0)))try{return JSON.parse(t)}catch(t){}return t},_parseEvent:t=>t.split(".").shift(),_parseEvents:t=>t.split(" "),_prefixSelectors(t,e){return t.split(this._splitRegExp).filter(t=>!!t).map(t=>`${e} ${t}`).join(", ")}}),Object.assign(i,{_clone(t,e){const s=t.cloneNode(e.deep);return e.events&&this._cloneEvents(t,s),e.data&&this._cloneData(t,s),e.animations&&this._cloneAnimations(t,s),e.deep&&this._deepClone(t,s,e),s},_cloneAnimations(t,e){if(!this._hasAnimation(t))return;const s=n._animations.get(t).map(t=>new n(e,t._callback,t._options));n._animations.set(e,s)},_deepClone(t,s,o){const r=e.wrap(t.childNodes),n=e.wrap(s.childNodes);for(let e=0;e<r.length;e++)o.events&&this._cloneEvents(r[e],n[e]),o.data&&this._cloneData(r[e],n[e]),o.animations&&this._cloneAnimations(t,s),this._deepClone(r[e],n[e],o)},_detach(t){const e=t.parentNode;e||e.removeChild(t)},_empty(t){const s=e.wrap(t.childNodes);for(const e of s)this._remove(e),t.removeChild(e);if(this._hasShadow(t)){const e=t.shadowRoot;this._remove(e)}if(this._hasFragment(t)){const e=t.content;this._remove(e)}},_remove(t){const s=new Event("remove");t.dispatchEvent(s),this._empty(t),e.isElement(t)&&(this._clearQueue(t),n.stop(t),this._styles.has(t)&&this._styles.delete(t)),this._removeEvent(t),this._removeData(t)}}),Object.assign(i,{_unwrap(t){const s=t.parentNode;if(!s)return;const o=e.wrap(t.childNodes);for(const e of o)s.insertBefore(e,t);this._remove(t),s.removeChild(t)},_wrap(t,s){const o=t.parentNode;if(!o)return;const r=s.map(t=>this._clone(t,{deep:!0,events:!0,data:!0,animations:!0})),n=r.slice().shift(),i=this._deepest(e.isFragment(n)?n.firstChild:n);for(const e of r)o.insertBefore(e,t);i.insertBefore(t,null)},_wrapAll(t,s){const o=t[0];if(!o)return;const r=o.parentNode;if(!r)return;const n=s[0],i=this._deepest(e.isFragment(n)?n.firstChild:n);for(const t of s)r.insertBefore(t,o);for(const e of t)i.insertBefore(e,null)},_wrapInner(t,s){const o=e.wrap(t.childNodes),r=s.map(t=>this._clone(t,{deep:!0,events:!0,data:!0,animatinos:!0})),n=r.slice().shift(),i=this._deepest(e.isFragment(n)?n.firstChild:n);for(const e of r)t.insertBefore(e,null);for(const t of o)i.insertBefore(t,null)}}),Object.assign(i,{parseHTML:t=>(new DOMParser).parseFromString(t,"text/html"),parseXML:t=>(new DOMParser).parseFromString(t,"application/xml")}),Object.assign(i,{_findBySelector(t,s){const o=[];for(const r of s)e.merge(o,r.querySelectorAll(t));return s.length>1&&o.length>1?e.unique(o):o},_findOneBySelector(t,e){for(const s of e){const e=s.querySelector(t);if(e)return e}return null}}),Object.assign(i,{_children(t,s,o=!1,r=!1){const n=e.wrap(r?t.children:t.childNodes),i=[];let a;for(a of n)if((!s||s(a))&&(i.push(a),o))break;return i},_deepest:t=>e.wrap(t.querySelectorAll("*")).find(t=>!t.childElementCount)||t,_next(t,e){const s=[];return(t=t.nextSibling)?(e&&!e(t)||s.push(t),s):s},_nextAll(t,e,s,o=!1){const r=[];for(;(t=t.nextSibling)&&(!s||!s(t))&&(e&&!e(t)||(r.push(t),!o)););return r},_parent(t,e){const s=[],o=t.parentNode;return o?(e&&!e(o)||s.push(o),s):s},_parents(t,s,o,r=!1){const n=[];for(;(t=t.parentNode)&&!e.isDocument(t)&&(!o||!o(t))&&(s&&!s(t)||(n.unshift(t),!r)););return n},_prev(t,e){const s=[];return(t=t.previousSibling)?(e&&!e(t)||s.push(t),s):s},_prevAll(t,e,s,o=!1){const r=[];for(;(t=t.previousSibling)&&(!s||!s(t))&&(e&&!e(t)||(r.unshift(t),!o)););return r},_siblings(t,e,s=!0){const o=[],r=t.parentNode;if(!r)return o;const n=s?r.children:r.childNodes;let i;for(i of n)t.isSameNode(i)||e&&!e(i)||o.push(i);return o}}),Object.assign(i,{parseNodesFactory:t=>t?s=>(t.node?e.isNode(s):e.isElement(s))||t.fragment&&e.isFragment(s)||t.shadow&&e.isShadow(s)||t.document&&e.isDocument(s)||t.window&&e.isWindow(s):e.isElement}),Object.assign(i,{_hasAnimation:t=>n._animations.has(t),_hasCSSAnimation(t){return!!parseFloat(this._css(t,"animation-duration"))},_hasCSSTransition(t){return!!parseFloat(this._css(t,"transition-duration"))},_hasData(t,e){return this._data.has(t)&&(!e||this._data.get(t).hasOwnProperty(e))},_hasFragment:t=>!!t.content,_hasShadow:t=>!!t.shadowRoot,_isVisible:t=>e.isWindow(t)?"visible"===t.document.visibilityState:e.isDocument(t)?"visible"===t.visibilityState:!!t.offsetParent}),Object.assign(i,{_forceShow(t,s){if(this._isVisible(t))return s(t);const o=[];e.isElement(t)&&"none"===this._css(t,"display")&&o.push(t),e.merge(o,this._parents(t,t=>e.isElement(t)&&"none"===this._css(t,"display")));const r=new Map;for(const t of o)r.set(t,t.getAttribute("style")),t.style.setProperty("display","initial","important");const n=s(t);for(const[t,e]of r)e?t.setAttribute("style",e):(t.getAttribute("style"),t.removeAttribute("style"));return n},_sanitize(t,e,s=this.allowedTags){const o=this._tagName(t);if(!(o in s))return void e.removeChild(t);const r=[];"*"in s&&s["*"].length&&r.push(...s["*"]),s[o].length&&r.push(...s[o]);const n=this._getAttribute(t);for(const e in n){!!r.find(t=>e.match(t))||t.removeAttribute(e)}const i=this._children(t,null,!1,!0);for(const e of i)this._sanitize(e,t,s)},_sort:t=>t.sort((t,s)=>{if(e.isWindow(t))return 1;if(e.isWindow(s))return-1;if(e.isDocument(t))return 1;if(e.isDocument(s))return-1;if(e.isFragment(s))return 1;if(e.isFragment(t))return-1;if(e.isShadow(t)&&(t=t.host),e.isShadow(s)&&(s=s.host),t.isSameNode(s))return 0;const o=t.compareDocumentPosition(s);return o&Node.DOCUMENT_POSITION_FOLLOWING||o&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:o&Node.DOCUMENT_POSITION_PRECEDING||o&Node.DOCUMENT_POSITION_CONTAINS?1:0}),_tagName:t=>t.tagName.toLowerCase()}),Object.assign(i,{_queues:new WeakMap,_data:new WeakMap,_events:new WeakMap,_styles:new WeakMap,allowedTags:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},cssNumberProperties:["font-weight","line-height","opacity","orphans","widows","z-index"],INNER:0,OUTER:2,OUTER_MARGIN:3,_complexRegExp:/(?:^\s*[\>\+\~]|\,(?=(?:(?:[^"']*["']){2})*[^"']*$)\s*[\>\+\~])/,_fastRegExp:/^([\#\.]?)([\w\-]+)$/,_splitRegExp:/\,(?=(?:(?:[^"]*"){2})*[^"]*$)\s*/}),{AjaxRequest:o,Animation:n,DOM:i,dom:new i}}));