!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t:Object.assign(e,t(e))}(this,function(e){"use strict";if(!e)throw new Error("FrostDOM requires a Window.");if(!("Core"in e))throw new Error("FrostDOM requires FrostCore.");if(!e.Core.isWindow(e))throw new Error("FrostDOM requires a valid Window object.");const t=e.Core,s=e.document;class i{constructor(e=s){this.context=e,this._animating=!1,this._animations=new Map,this._queues=new WeakMap,this._data=new WeakMap,this._events=new WeakMap,this._styles=new WeakMap}}return Object.assign(i.prototype,{ajax(t){if(!(t={url:e.location,headers:{},...i.ajaxDefaults,...t}).cache){const e=new URL(t.url);e.searchParams.append("_",Date.now()),t.url=e.toString()}return"Content-Type"in t.headers&&!t.headers["Content-Type"]&&(t.headers["Content-Type"]=t.contentType),"X-Requested-With"in t.headers||(t.headers["X-Requested-With"]="XMLHttpRequest"),new Promise((e,s)=>{const n=new XMLHttpRequest;n.open(t.method,t.url,!0);for(const e of t.headers)n.setRequestHeader(e,t.headers[e]);t.responseType&&(n.responseType=t.responseType),n.onload=(t=>{n.status>400?s({status:n.status,xhr:n,event:t}):e({response:n.response,xhr:n,event:t})}),n.onerror=(e=>s({status:n.status,xhr:n,event:e})),t.uploadProgress&&(n.upload.onprogress=(e=>t.uploadProgress(e.loaded/e.total,n,e))),t.beforeSend&&t.beforeSend(n),t.data&&t.processData&&("application/json"===t.contentType?t.data=JSON.stringify(t.data):"application/x-www-form-urlencoded"===t.contentType?t.data=i._parseParams(t.data):t.data=i._parseFormData(t.data)),n.send(t.data)})},get(e,t){return this.ajax({url:e,...t})},post(e,t,s){return this.ajax({url:e,data:t,method:"POST",...s})},upload(e,t,s){return this.ajax({url:e,data:t,method:"POST",contentType:!1,...s})},loadScript(t,s=!0){return this.ajax(t,{cache:s}).then(t=>eval.apply(e,t.response))},loadScripts(t,s=!0){return Promise.all(t.map(e=>this.ajax(e,{cache:s}))).then(t=>{for(const s of t)eval.apply(e,s.response)})},loadStyle(e,t=!0){return this.ajax(e,{cache:t}).then(e=>i._append(this.context.head,this.create("style",{text:e.response})))},loadStyles(e,t=!0){return Promise.all(e.map(e=>this.ajax(e,{cache:t}))).then(e=>i._append(this.context.head,this.create("style",{text:e.map(e=>e.response).join("\r\n")})))}}),Object.assign(i.prototype,{getCookie(e,t=!1){const s=decodeURIComponent(this.context.cookie).split(";").find(t=>t.trimStart().substring(0,e.length)===e);if(!s)return null;const i=s.trimStart().substring(e.length+1);return t?JSON.parse(i):i},removeCookie(e,t){this.setCookie(e,"",{expires:-1,...t})},setCookie(e,t,s,i=!1){if(!e)return;i&&(t=JSON.stringify(t));let n=`${e}=${t}`;if(s){if(s.expires){let e=new Date;e.setTime(e.getTime()+1e3*s.expires),n+=`;expires=${e.toUTCString()}`}s.path&&(n+=`;path=${s.path}`),s.secure&&(n+=";secure")}this.context.cookie=n}}),Object.assign(i.prototype,{animate(e,t,s){s={...i.animationDefaults,...s};const n=this._nodeFilter(e).map(e=>this._animate(e,t,s));return this._start(),Promise.all(n)},stop(e,t=!0){for(const s of this._nodeFilter(e))this._stop(s,t)},_animate(e,s,i){this._animations.has(e)||this._animations.set(e,[]);const n=performance.now();return new Promise((r,o)=>{this._animations.get(e).push((a=!1,l=!1)=>{if(a&&!l)return o(e),!0;let c;return l?c=1:(c=(performance.now()-n)/i.duration,i.infinite?c%=1:c=t.clamp(c),"ease-in"===i.type?c=Math.pow(c,2):"ease-out"===i.type?c=Math.sqrt(c):"ease-in-out"===i.type&&(c=c<=.5?2*Math.pow(c,2):1-(1-c)**2*2)),s(e,c,i),1===c?(r(e),!0):void 0})})},_animationFrame(){for(const[e,t]of this._animations)t=t.filter(e=>!e()),t.length?this.animations.set(e,t):this.animations.delete(e);this._animations.size?e.requestAnimationFrame(e=>this._animationFrame()):this._animating=!1},_start(){this._animating||(this._animating=!0,this._animationFrame())},_stop(e,t=!0){if(this._animations.has(e)){for(const s of this._animations.get(e))s(!0,t);this._animations.delete(e)}}}),Object.assign(i.prototype,{dropIn(e,t){return this.slideIn(e,{direction:"top",...t})},dropOut(e,t){return this.slideOut(e,{direction:"top",...t})},fadeIn(e,t){return this.animate(e,(e,t)=>i._setStyle(e,{opacity:t<1?t:""}),t)},fadeOut(e,t){return this.animate(e,(e,t)=>i._setStyle(e,{opacity:t<1?1-t:""}),t)},rotateIn(e,t){return this.animate(e,(e,t,s)=>i._setStyle(e,{transform:t<1?`rotate3d(${s.x}, ${s.y}, 0, ${(90-90*t)*(s.inverse?-1:1)}deg)`:""}),{x:0,y:1,...t})},rotateOut(e,t){return this.animate(e,(e,t,s)=>i._setStyle(e,{transform:t<1?`rotate3d(${s.x}, ${s.y}, 0, ${90*t*(s.inverse?-1:1)}deg)`:""}),{x:0,y:1,...t})},slideIn(e,s){return this.animate(e,(e,s,n)=>{let r;if(s<1){const i=t.isFunction(n.direction)?n.direction():n.direction;let o,a,l;"top"===i||"bottom"===i?(o="Y",a=this._height(e),l="top"===i):(o="X",a=this._width(e),l="left"===i),r=`translate${o}(${Math.round(a-a*s)*(l?-1:1)}px)`}else r="";i._setStyle(e,{transform:r})},{direction:"bottom",...s})},slideOut(e,s){return this.animate(e,(e,s,n)=>{let r;if(s<1){const i=t.isFunction(n.direction)?n.direction():n.direction;let o,a,l;"top"===i||"bottom"===i?(o="Y",a=this._height(e),l="top"===i):(o="X",a=this._width(e),l="left"===i),r=`translate${o}(${Math.round(a*s)*(l?-1:1)}px)`}else r="";i._setStyle(e,{transform:r})},{direction:"bottom",...s})},squeezeIn(e,t){return t={direction:"bottom",...t},Promise.all(this._nodeFilter(e).map(e=>this._squeezeIn(e,t)))},squeezeOut(e,t){return t={direction:"bottom",...t},Promise.all(this._nodeFilter(e).map(e=>this._squeezeOut(e,t)))},_squeezeIn(e,s){const n=this.create("div",{style:{overflow:"hidden",position:"relative"}});this._wrap(e,n);const r=i._parent(e).shift();return this.animate(e,(e,s,n)=>{if(1===s)return i._before(r,i._children(r,!1,!1,!1)),void this._remove(r);const o=t.isFunction(n.direction)?n.direction():n.direction;let a,l;"top"===o||"bottom"===o?(a="height","top"===o&&(l="Y")):"left"!==o&&"right"!==o||(a="width","left"===o&&(l="X"));const c=Math.round(this[`_${a}`](e)),h=Math.round(c*s),d={[a]:h+"px"};l&&(d.transform=`translate${l}(${c-h}px)`),i._setStyle(r,d)},s)},_squeezeOut(e,s){const n=this.create("div",{style:{overflow:"hidden",position:"relative"}});this._wrap(e,n);const r=i._parent(e).shift();return this.animate(e,(e,s,n)=>{if(1===s)return i._before(r,i._children(r,!1,!1,!1)),void this._remove(r);const o=t.isFunction(n.direction)?n.direction():n.direction;let a,l;"top"===o||"bottom"===o?(a="height","top"===o&&(l="Y")):"left"!==o&&"right"!==o||(a="width","left"===o&&(l="X"));const c=Math.round(this[`_${a}`](e)),h=Math.round(c-c*s),d={[a]:h+"px"};l&&(d.transform=`translate${l}(${c-h}px)`),i._setStyle(r,d)},s)}}),Object.assign(i.prototype,{queue(e,t){for(const s of this._nodeFilter(e))this._queue(s,t)},clearQueue(e){for(const t of this._nodeFilter(e))this._clearQueue(t)},_clearQueue(e){this._queues.has(e)&&this._queues.delete(e)},_dequeueNode(e){if(!this._queues.has(e))return;const t=this._queues.get(e).shift();t?Promise.resolve(t(e)).finally(t=>this._dequeueNode(e)):this._queues.delete(e)},_queue(e,t){const s=!this._queues.has(e);s&&this._queues.set(e,[]),this._queues.get(e).push(t),s&&this._dequeueNode(e)}}),Object.assign(i.prototype,{getAttribute(e,t){const s=this._nodeFind(e);if(s)return i._getAttribute(s,t)},getDataset(e,t){const s=this._nodeFind(e);if(s)return i._getDataset(s,t)},getHTML(e){return this.getProperty(e,"innerHTML")},getProperty(e,t){const s=this._nodeFind(e);if(s)return i._getProperty(s,t)},getText(e){return this.getProperty(e,"innerText")},getValue(e){return this.getProperty(e,"value")},removeAttribute(e,t){for(const s of this._nodeFilter(e))i._removeAttribute(s,t)},removeProperty(e,t){for(const s of this._nodeFilter(e))i._removeProperty(s,t)},setAttribute(e,t,s){const n=i._parseData(t,s);for(const t of this._nodeFilter(e))i._setAttribute(t,n)},setDataset(e,t,s){const n=i._parseData(t,s);for(const t of this._nodeFilter(e))i._setDataset(t,n)},setHTML(e,t){this.empty(e),this.setProperty(e,"innerHTML",t)},setProperty(e,t,s){const n=i._parseData(t,s);for(const t of this._nodeFilter(e))i._setProperty(t,n)},setText(e,t){this.empty(e),this.setProperty(e,"innerText",t)},setValue(e,t){this.setProperty(e,"value",t)}}),Object.assign(i.prototype,{cloneData(e,s){for(const n of this._nodeFilter(e,e=>i.isNode(e)||i.isDocument(e)||t.isWindow(e)))this._cloneData(n,s)},getData(e,s){const n=this._nodeFind(e,e=>i.isNode(e)||i.isDocument(e)||t.isWindow(e));if(n)return this._getData(n,s)},removeData(e,s){for(const n of this._nodeFilter(e,e=>i.isNode(e)||i.isDocument(e)||t.isWindow(e)))this._removeData(n,s)},setData(e,s,n){const r=i._parseData(s,n);for(const s of this._nodeFilter(e,e=>i.isNode(e)||i.isDocument(e)||t.isWindow(e)))this._setData(s,r)},_cloneData(e,t){this._data.has(e)&&this.setData(t,{...this._data.get(e)})},_getData(e,t){if(this._data.has(e))return t?this._data.get(e)[t]:this._data.get(e)},_removeData(e,t){if(this._data.has(e)){if(t){const s=this._data.get(e);if(delete s[t],Object.keys(s).length)return}this._data.delete(e)}},_setData(e,t){this._data.has(e)||this._data.set(e,{}),Object.assign(this._data.get(e),t)}}),Object.assign(i.prototype,{center(e,t){const s=this.rect(e,t);if(s)return{x:s.left+s.width/2,y:s.top+s.height/2}},constrain(e,t){const s=this.rect(t);if(s)for(const t of this._nodeFilter(e))this._constrain(t,s)},distTo(e,s,i,n){const r=this.center(e,n);if(r)return t.dist(r.x,r.y,s,i)},distToNode(e,t){const s=this.center(t);if(s)return this.distTo(e,s.x,s.y)},nearestTo(e,t,s,i){let n=null,r=Number.MAX_VALUE;for(const o of this._nodeFilter(e)){const e=this.distTo(o,t,s,i);e&&e<r&&(r=e,n=o)}return n},nearestToNode(e,t){const s=this.center(t);if(s)return this.nearestTo(e,s.x,s.y)},percentX(e,s,i){const n=this.rect(e,i);if(n)return t.clampPercent((s-n.left)/n.width*100)},percentY(e,s,i){const n=this.rect(e,i);if(n)return t.clampPercent((s-n.top)/n.height*100)},position(e,t){const s=this._nodeFind(e);if(s)return this._position(s,t)},rect(e,t){const s=this._nodeFind(e);if(s)return this._rect(s,t)},_constrain(e,t){const s=this._rect(e);s.height>t.height&&i._setStyle(e,{height:t.height}),s.width>t.width&&i._setStyle(e,{width:t.width}),s.top<t.top&&i._setStyle(e,{top:t.top}),s.right>t.right&&i._setStyle(e,{right:t.right-s.width}),s.bottom>t.bottom&&i._setStyle(e,{top:t.bottom-s.height}),s.left<t.left&&i._setStyle(e,{left:t.left})},_position(e,t){return this.forceShow(e,e=>{const s={x:e.offsetLeft,y:e.offsetTop};if(t){let t=e;for(;t=t.offsetParent;)s.x+=t.offsetLeft,s.y+=t.offsetTop}return s})},_rect(t,s){return this.forceShow(t,t=>{const n=t.getBoundingClientRect();return s&&(n.x+=i._getScrollX(e),n.y+=i._getScrollY(e)),n})}}),Object.assign(i.prototype,{getScrollX(e){const s=this._nodeFind(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e));if(s)return i._getScrollX(s)},getScrollY(e){const s=this._nodeFind(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e));if(s)return i._getScrollY(s)},setScroll(e,s,n){for(const r of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))i._setScroll(r,s,n)},setScrollX(e,s){for(const n of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))i._setScrollX(n,s)},setScrollY(e,s){for(const n of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))i._setScrollY(n,s)}}),Object.assign(i.prototype,{height(e,s=!0,n,r){const o=this._nodeFind(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e));if(o)return this._height(o,s,n,r)},width(e,s=!0,n,r){const o=this._nodeFind(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e));if(o)return this._width(o,s,n,r)},_height(e,s=!0,n,r){return t.isWindow(e)?s?e.outerHeight:e.innerHeight:(i.isDocument(e)&&(e=e.documentElement),this.forceShow(e,e=>{let t=e.clientHeight;return s||(t-=parseInt(this._css(e,"padding-top"))+parseInt(this._css(e,"padding-bottom"))),n&&(t+=parseInt(this._css(e,"border-top-width"))+parseInt(this._css(e,"border-bottom-width"))),r&&(t+=parseInt(this._css(e,"margin-top"))+parseInt(this._css(e,"margin-bottom"))),t}))},_width(e,s=!0,n,r){return t.isWindow(e)?s?e.outerWidth:e.innerWidth:(i.isDocument(e)&&(e=e.documentElement),this.forceShow(e,e=>{let t=e.clientWidth;return s||(t-=parseInt(this._css(e,"padding-left"))+parseInt(this._css(e,"padding-right"))),n&&(t+=parseInt(this._css(e,"border-left-width"))+parseInt(this._css(e,"border-right-width"))),r&&(t+=parseInt(this._css(e,"margin-left"))+parseInt(this._css(e,"margin-right"))),t}))}}),Object.assign(i.prototype,{addClass(e,...t){if((t=i._parseClasses(t)).length)for(const s of this._nodeFilter(e))i._addClass(s,t)},css(e,t){const s=this._nodeFind(e);if(s)return this._css(s,t)},getStyle(e,s){s=t.snakeCase(s);const n=this._nodeFind(e);if(n)return i._getStyle(n,s)},hide(e){this.setStyle(e,"display","none")},removeClass(e,...t){if((t=i._parseClasses(t)).length)for(const s of this._nodeFilter(e))i._removeClass(s,t)},setStyle(e,s,n,r){const o=i._parseData(s,n),a={};for(let e in o){let s=`${o[e]}`;e=t.snakeCase(e),s&&t.isNumeric(s)&&!i.cssNumberProperties.includes(e)&&(s+="px"),a[e]=s}for(const t of this._nodeFilter(e))i._setStyle(t,a,r)},show(e){this.setStyle(e,"display","")},toggle(e){for(const t of this._nodeFilter(e))i._toggle(t)},toggleClass(e,...t){if((t=i._parseClasses(t)).length)for(const s of this._nodeFilter(e))i._toggleClass(s,t)},_css(t,s){return this._styles.has(t)||this._styles.set(t,e.getComputedStyle(t)),this._styles.get(t).getPropertyValue(s)}}),Object.assign(i.prototype,{blur(e){const t=this._nodeFind(e);t&&i._blur(t)},click(e){const t=this._nodeFind(e);t&&i._click(t)},focus(e){const t=this._nodeFind(e);t&&i._focus(t)},ready(t){"complete"!==this.context.readyState?this._addEvent(e,"DOMContentLoaded",t):t()},triggerEvent(e,s,n){for(const r of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))i._triggerEvent(r,s,n)}}),Object.assign(i.prototype,{addEvent(e,s,n){for(const r of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))this._addEvent(r,s,n)},addEventDelegate(e,s,n,r){for(const o of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))this._addEvent(o,s,r,n)},addEventDelegateOnce(e,s,n,r){for(const o of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))this._addEvent(o,s,r,n,!0)},addEventOnce(e,s,n){for(const r of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))this._addEvent(r,s,n,null,!0)},cloneEvents(e,s){for(const n of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))this._cloneEvents(n,s)},removeEvent(e,s,n){for(const r of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))this._removeEvent(r,s,n)},removeEventDelegate(e,s,n,r){for(const o of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)))this._removeEvent(o,s,r,n)},_addEvent(e,t,s,n,r){let o=s;r&&(o=this._selfDestructFactory(e,t,n,o)),n&&(o=this._delegateFactory(e,n,o)),this._events.has(e)||this._events.set(e,{});const a=this._events.get(e),l={delegate:n,callback:s,realCallback:o,selfDestruct:r};for(const s of i._parseEvents(t)){const t=i._parseEvent(s);if(l.event=s,l.realEvent=t,a[t]){if(a[t].includes(l))return}else a[t]=[];e.addEventListener(t,o),a[t].push(l)}},_cloneEvents(e,t){if(!this._events.has(e))return;const s=this._events.get(e);for(const e in s)for(const i of s[e])this.addEvent(t,i.event,i.callback,i.delegate,i.selfDestruct)},_removeEvent(e,t,s,n){if(!this._events.has(e))return;const r=this._events.get(e),o=t?i._parseEvents(t):Object.keys(r);for(const t of o){const o=i._parseEvent(t);if(!r[o])return;r[o]=r[o].filter(i=>!!(o===t&&o!==i.realEvent||o!==t&&t!==i.event||n&&(n!==i.delegate||s&&s!==i.callback)||!n&&s&&s!==i.realCallback)||(e.removeEventListener(i.realEvent,i.realCallback),!1)),r[o].length||delete r[o]}Object.keys(r).length||this._events.delete(e)}}),Object.assign(i.prototype,{create(e,t){const s=this.context.createElement(e);return t?("html"in t?this.setHTML(s,t.html):"text"in t&&this.setText(s,t.text),"class"in t&&this.addClass(s,t.class),"style"in t&&this.setStyle(s,t.style),"value"in t&&this.setValue(s,t.value),"attributes"in t&&this.setAttribute(s,t.attributes),"properties"in t&&this.setProperty(s,t.properties),"dataset"in t&&this.setDataset(s,t.dataset),s):s},createComment(e){return this.context.createComment(e)},createText(e){return this.context.createTextNode(e)}}),Object.assign(i.prototype,{clone(e,t=!0,s=!1,n=!1){return this._nodeFilter(e,i.isNode).map(e=>this._clone(e,t,s,n))},detach(e){for(const t of this._nodeFilter(e,i.isNode))i._detach(t)},empty(e){for(const t of this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)))this._empty(t)},extractSelection(){const s=e.getSelection();if(!s.rangeCount)return[];const i=s.getRangeAt(0);return s.removeAllRanges(),t.merge([],i.extractContents().childNodes)},remove(e){for(const t of this._nodeFilter(e,i.isNode))this._remove(t)},replaceAll(e,t){this.replaceWith(t,e)},replaceWith(e,t){t=this._parseQuery(t,i.isNode);for(const s of this._nodeFilter(e,i.isNode))this._replaceWith(s,t)},_clone(e,t,s,i){const n=e.cloneNode(t);return s||i?(s&&this._cloneEvents(e,n),i&&this._cloneData(e,n),t&&this._deepClone(e,n,s,i),n):n},_deepClone(e,t,s,n){const r=i._children(e,!1,!1,!1),o=i._children(t,!1,!1,!1);for(let e=0;e<r.length;e++)s&&this._cloneEvents(r[e],o[e]),n&&this._cloneData(r[e],o[e]),this._deepClone(r[e],o[e])},_empty(e){for(const t of i._children(e,!1,!1,!1))this._remove(t)},_remove(e){i.isElement(e)&&this._empty(e),this._clearQueue(e),this._stop(e),this._styles.has(e)&&this._styles.delete(e),i._detach(e),i._triggerEvent(e,"remove"),this._removeEvent(e),this._removeData(e)},_replaceWith(e,t){i._before(e,this.clone(t,!0)),this._remove(e)}}),Object.assign(i.prototype,{after(e,t){const s=this._nodeFind(e,i.isNode);s&&i._after(s,this._parseQuery(t,i.isNode))},afterSelection(t){const s=e.getSelection();if(!s.rangeCount)return;const n=s.getRangeAt(0);s.removeAllRanges(),n.collapse();for(const e of this._parseQuery(t,i.isNode))n.insertNode(e)},append(e,t){const s=this._nodeFind(e);s&&i._append(s,this._parseQuery(t,i.isNode))},appendTo(e,t){this.append(t,e)},before(e,t){const s=this._nodeFind(e,i.isNode);s&&i._before(s,this._parseQuery(t,i.isNode))},beforeSelection(t){const s=e.getSelection();if(!s.rangeCount)return;const n=s.getRangeAt(0);s.removeAllRanges();for(const e of this._parseQuery(t,i.isNode))n.insertNode(e)},insertAfter(e,t){this.after(t,e)},insertBefore(e,t){this.before(t,e)},prepend(e,t){const s=this._nodeFind(e);s&&i._prepend(s,this._parseQuery(t,i.isNode))},prependTo(e,t){this.prepend(t,e)}}),Object.assign(i.prototype,{unwrap(e,t){for(const s of this._nodeFilter(e,i.isNode))this._unwrap(s,t)},wrap(e,t){t=this._parseQuery(t);for(const s of this._nodeFilter(e,i.isNode))this._wrap(s,t)},wrapAll(e,s){s=this._parseQuery(s);const n=this.clone(s,!0);i._before(e,n);const r=n.shift();i._append(t.merge([],i._findBySelector("*",r)).find(e=>!i._hasChildren(e))||r,e)},wrapInner(e,t){t=this._parseQuery(t);for(const s of this._nodeFilter(e,i.isNode))this._wrapInner(s,t)},wrapSelection(s){const n=e.getSelection();if(!n.rangeCount)return;s=this._parseQuery(s);const r=n.getRangeAt(0);n.removeAllRanges();const o=s.slice().shift();i._append(t.merge([],i._findBySelector("*",o)).find(e=>!i._hasChildren(e))||o,t.merge([],r.extractContents().childNodes));for(const e of s)r.insertNode(e)},_unwrap(e,t){const s=i._parent(e,t).shift();s&&(i._before(s,i._children(s,!1,!1,!1)),this._remove(s))},_wrap(e,s){const n=this.clone(s,!0);i._before(e,n);const r=n.shift();i._append(t.merge([],i._findBySelector("*",r)).find(e=>!i._hasChildren(e))||r,[e])},_wrapInner(e,s){const n=this.clone(s,!0);i._append(e,n);const r=n.shift();i._append(t.merge([],i._findBySelector("*",r)).find(e=>!i._hasChildren(e))||r,i._children(e,!1,!1,!1))}}),Object.assign(i.prototype,{filter(e,t){return t=this._parseFilter(t),this._nodeFilter(e).filter((e,s)=>!t||t(e,s))},filterOne(e,t){return t=this._parseFilter(t),this._nodeFilter(e).find((e,s)=>!t||t(e,s))||null},not(e,t){return(t=this._parseFilter(t))?this._nodeFilter(e).filter((e,s)=>!t(e,s)):[]},notOne(e,t){return(t=this._parseFilter(t))&&this._nodeFilter(e).find((e,s)=>!t(e,s))||null},has(e,t){return t=this._parseFilterContains(t),this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)).filter((e,s)=>!t||t(e,s))},hasOne(e,t){return t=this._parseFilterContains(t),this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)).find((e,s)=>!t||t(e,s))||null},hidden(e){return this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)).filter(e=>this.isHidden(e))},hiddenOne(e){return this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)).find(e=>this.isHidden(e))||null},visible(e){return this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)).filter(e=>this.isVisible(e))},visibleOne(e){return this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)).find(e=>this.isVisible(e))||null}}),Object.assign(i.prototype,{find(e,t=this.context){const s=e.match(i.fastRegex);return s?"#"===s[1]?this.findById(s[2]):"."===s[1]?this.findByClass(s[2],t):this.findByTag(s[2],t):e.match(i.complexRegex)?this._findByCustom(e,t):this._findBySelector(e,t)},findByClass(e,s=this.context){if(i.isElement(s)||i.isDocument(s))return t.merge([],i._findByClass(e,s));s=this._nodeFilter(s,e=>i.isElement(e)||i.isDocument(e));const n=[];for(const r of s)t.merge(n,i._findByClass(e,r));return s.length>1&&n.length>1?t.unique(n):n},findById(e,t=this.context){const s=i._findById(e,this.context);return!s||t!==this.context&&!this.hasOne(t,s)?[]:[s]},findByTag(e,s=this.context){if(i.isElement(s)||i.isDocument(s))return t.merge([],i._findByTag(e,s));s=this._nodeFilter(s,e=>i.isElement(e)||i.isDocument(e));const n=[];for(const r of s)t.merge(n,i._findByTag(e,r));return s.length>1&&n.length>1?t.unique(n):n},findOne(e,t=this.context){const s=e.match(i.fastRegex);return s?"#"===s[1]?this.findOneById(s[2]):"."===s[1]?this.findOneByClass(s[2],t):this.findOneByTag(s[2],t):e.match(i.complexRegex)?this._findOneByCustom(e,t):this._findOneBySelector(e,t)},findOneByClass(e,t=this.context){if(i.isElement(t)||i.isDocument(t))return i._findByClass(e,t).item(0);t=this._nodeFilter(t,e=>i.isElement(e)||i.isDocument(e));for(const s of t){const t=i._findByClass(e,s).item(0);if(t)return t}return null},findOneById(e,t=this.context){const s=i._findById(e,this.context);return!s||t!==this.context&&!this.hasOne(t,s)?null:s},findOneByTag(e,t=this.context){if(i.isElement(t)||i.isDocument(t))return i._findByTag(e,t).item(0);t=this._nodeFilter(t,e=>i.isElement(e)||i.isDocument(e));for(const s of t){const t=i._findByTag(e,s).item(0);if(t)return t}return null},_findByCustom(e,s=this.context){if(t.isString(s))return i._findBySelector(i._prefixSelectors(e,`${s} `),this.context);const n=i._prefixSelectors(e,`#${i.tempId} `);if(i.isElement(s)||i.isDocument(s))return t.merge([],i._findByCustom(n,s));s=this._nodeFilter(s,e=>i.isElement(e)||i.isDocument(e));const r=[];for(const e of s)t.merge(r,i._findByCustom(n,e));return s.length>1&&r.length>1?t.unique(r):r},_findBySelector(e,s=this.context){if(i.isElement(s)||i.isDocument(s))return t.merge([],i._findBySelector(e,s));s=this._nodeFilter(s,e=>i.isElement(e)||i.isDocument(e));const n=[];for(const r of s)t.merge(n,i._findBySelector(e,r));return s.length>1&&n.length>1?t.unique(n):n},_findOneByCustom(e,s=this.context){if(t.isString(s))return i._findOneBySelector(i._prefixSelectors(e,`${s} `),this.context);const n=i._prefixSelectors(e,`#${i.tempId} `);if(i.isElement(s)||i.isDocument(s))return i._findOneByCustom(n,s);s=this._nodeFilter(s,e=>i.isElement(e)||i.isDocument(e));for(const e of s){const t=i._findOneByCustom(n,e);if(t)return t}return null},_findOneBySelector(e,t=this.context){if(i.isElement(t)||i.isDocument(t))return i._findOneBySelector(e,t);t=this._nodeFilter(t,e=>i.isElement(e)||i.isDocument(e));for(const s of t){const t=i._findOneBySelector(e,s);if(t)return t}return null}}),Object.assign(i.prototype,{child(e,t){return this.children(e,t,!0)},children(e,s,n=!1,r=!0){if(s=this._parseFilter(s),i.isElement(e))return i._children(e,s,n,r);e=this._nodeFilter(e);const o=[];for(const a of e)t.merge(o,i._children(a,s,n,r));return e.length>1&&o.length>1?t.unique(o):o},closest(e,t,s){return this.parents(e,t,s,!0)},commonAncestor(e){if(!(e=this.sortNodes(e)).length)return;const t=this.context.createRange();return 1==e.length?t.selectNode(e.shift()):(t.setStartBefore(e.shift()),t.setEndAfter(e.pop())),t.commonAncestorContainer},contents(e){return this.children(e,!1,!1,!1)},parent(e,s){if(s=this._parseFilter(s),i.isNode(e))return i._parent(e,s);e=this._nodeFilter(e,i.isNode);const n=[];for(const r of e)t.merge(n,i._parent(r,s));return e.length>1&&n.length>1?t.unique(n):n},parents(e,s,n,r=!1){if(s=this._parseFilter(s),n=this._parseFilter(n),i.isNode(e))return i._parent(e,s,n,r);e=this._nodeFilter(e,i.isNode);const o=[];for(const a of e)t.merge(o,i._parents(a,s,n,r));return e.length>1&&o.length>1?t.unique(o):o},offsetParent(e){return this.forceShow(e,e=>e.offsetParent)},next(e,s){if(s=this._parseFilter(s),i.isElement(e))return i._next(e,s);e=this._nodeFilter(e);const n=[];for(const r of e)t.merge(n,i._next(r,s));return e.length>1&&n.length>1?t.unique(n):n},nextAll(e,s,n,r=!1){if(s=this._parseFilter(s),n=this._parseFilter(n),i.isElement(e))return i._nextAll(e,s,n,r);e=this._nodeFilter(e);const o=[];for(const a of e)t.merge(o,i._nextAll(a,s,n,r));return e.length>1&&o.length>1?t.unique(o):o},prev(e,s){if(s=this._parseFilter(s),i.isElement(e))return i._prev(e,s);e=this._nodeFilter(e);const n=[];for(const r of e)t.merge(n,i._prev(r,s));return e.length>1&&n.length>1?t.unique(n):n},prevAll(e,s,n,r=!1){if(s=this._parseFilter(s),n=this._parseFilter(n),i.isElement(e))return i._prevAll(e,s,n,r);e=this._nodeFilter(e);const o=[];for(const a of e)t.merge(o,i._prevAll(a,s,n,r));return e.length>1&&o.length?t.unique(o):o},siblings(e,s,n=!0){if(s=this._parseFilter(s),i.isElement(e))return i._siblings(e,s,n);e=this._nodeFilter(e);const r=[];for(const n of e)t.merge(r,i._siblings(n,s,elementsOnlyt));return e.length>1&&r.length>1?t.unique(r):r}}),Object.assign(i.prototype,{getSelection(){const s=e.getSelection();if(!s.rangeCount)return[];const n=s.getRangeAt(0),r=t.merge([],i._findBySelector("*",n.commonAncestorContainer));if(!r.length)return[n.commonAncestorContainer];if(1===r.length)return r;const o=i.isElement(n.startContainer)?n.startContainer:i._parent(n.startContainer).shift(),a=i.isElement(n.endContainer)?n.endContainer:i._parent(n.endContainer).shift();return r.slice(r.indexOf(o),r.indexOf(a)+1)},select(t){const s=this._nodeFind(t,i.isNode);if(s&&s.select)return s.select();const n=e.getSelection();if(n.rangeCount>0&&n.removeAllRanges(),!s)return;const r=this.context.createRange();r.selectNode(s),n.addRange(r)},selectAll(t){const s=e.getSelection();if(s.rangeCount&&s.removeAllRanges(),!(t=this.sortNodes(t)).length)return;const i=this.context.createRange();1==t.length?i.selectNode(t.shift()):(i.setStartBefore(t.shift()),i.setEndAfter(t.pop())),s.addRange(i)}}),Object.assign(i.prototype,{contains(e,t){return t=this._parseFilterContains(t),this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)).some(e=>!t||t(e))},hasAnimation(e){return this._nodeFilter(e).some(e=>!!parseFloat(this._css(e,"animation-duration")))},hasAttribute(e,t){return this._nodeFilter(e).some(e=>e.hasAttribute(t))},hasClass(e,...t){return t=i._parseClasses(t),this._nodeFilter(e).some(e=>t.some(t=>e.classList.contains(t)))},hasData(e,s){return this._nodeFilter(e,e=>i.isElement(e)||i.isDocument(e)||t.isWindow(e)).some(e=>this.nodeData.has(e)&&(!s||this.nodeData.get(e).hasOwnProperty(s)))},hasProperty(e,t){return this._nodeFilter(e).some(e=>e.hasOwnProperty(t))},hasTransition(e){return this._nodeFilter(e).some(e=>!!parseFloat(this._css(e,"transition-duration")))},is(e,t){return t=this._parseFilter(t),this._nodeFilter(e).some(e=>!t||t(e))},isConnected(e){return this._nodeFilter(e,i.isNode).some(e=>i._isConnected(e))},isFixed(e){return this._nodeFilter(e).some(e=>"fixed"===this._css(e,"position")||this._parents(e,e=>"fixed"===this._css(e,"position"),!1,!0).length)},isHidden(e){return this._nodeFilter(e,e=>i.isNode(e)||i.isDocument(e)||t.isWindow(e)).some(e=>!i._isVisible(e))},isVisible(e){return this._nodeFilter(e,e=>i.isNode(e)||i.isDocument(e)||t.isWindow(e)).some(e=>i._isVisible(e))}}),Object.assign(i.prototype,{exec(e,t=null){return this.context.execCommand(e,!1,t)},forceShow(e,s){const n=this._nodeFind(e,e=>i.isNode(e)||i.isDocument(e)||t.isWindow(e));if(!n)return;if(this.isVisible(n))return s(n);const r=new Map;"none"===this._css(n,"display")&&r.set(n,i._getAttribute(n,"style"));const o=this._parents(n,e=>"none"===this._css(e,"display"));for(const e of o)r.set(e,i._getAttribute(e,"style"));for(const e of r.keys())i._setStyle(e,{display:"initial"},!0);const a=s(n);for(const[e,t]of r)t?i._setStyle(e,{display:t}):i._removeAttribute(e,"style");return a},index(e,t){return t=this._parseFilter(t),this._nodeFilter(e).findIndex(e=>!t||t(e))},indexOf(e){const t=this._nodeFind(e);if(t)return this.children(this.parent(t)).indexOf(t)},serialize(e){return i._parseParams(this.serializeArray(e))},serializeArray(e){return this._nodeFilter(e).reduce((e,t)=>{if(i._is(t,"form"))return e.concat(this.serializeArray(i._findBySelector("input, select, textarea",t)));if(i._is(t,"[disabled], input[type=submit], input[type=reset], input[type=file], input[type=radio]:not(:checked), input[type=checkbox]:not(:checked)"))return e;const s=i._getAttribute(t,"name");if(!s)return e;const n=i._getAttribute(t,"value")||"";return e.push({name:s,value:n}),e},[])}}),Object.assign(i,{_getAttribute:(e,t)=>e.getAttribute(t),_getDataset:(e,t)=>t?e.dataset[t]:e.dataset,_getProperty:(e,t)=>e[t],_removeAttribute(e,t){e.removeAttribute(t)},_removeProperty(e,t){delete e[t]},_setAttribute(e,t){for(const s in t)e.setAttribute(s,t[s])},_setDataset(e,t){Object.assign(e.dataset,t)},_setProperty(e,t){Object.assign(e,t)}}),Object.assign(i,{_getScrollX(e){return t.isWindow(e)?e.scrollX:this.isDocument(e)?e.scrollingElement.scrollLeft:e.scrollLeft},_getScrollY(e){return t.isWindow(e)?e.scrollY:this.isDocument(e)?e.scrollingElement.scrollTop:e.scrollTop},_setScroll(e,s,i){return t.isWindow(e)?e.scroll(s,i):this.isDocument(e)?(e.scrollingElement.scrollLeft=s,void(e.scrollingElement.scrollTop=i)):(e.scrollLeft=s,void(e.scrollTop=i))},_setScrollX(e,s){if(t.isWindow(e))return e.scroll(s,e.scrollY);this.isDocument(e)?e.scrollingElement.scrollLeft=s:e.scrollLeft=s},_setScrollY(e,s){if(t.isWindow(e))return e.scroll(e.scrollX,s);this.isDocument(e)?e.scrollingElement.scrollTop=s:e.scrollTop=s}}),Object.assign(i,{_addClass(e,t){e.classList.add(...t)},_removeClass(e,t){e.classList.remove(...t)},_toggleClass(e,t){e.classList.toggle(...t)},_getStyle:(e,t)=>e.style[t],_setStyle(e,t,s=""){for(const i in t)e.style.setProperty(i,t[i],s?"important":"")},_toggle(e){"none"===this._getStyle(e,"display")?this._setStyle(e,{display:""}):this._setStyle(e,{display:"none"})}}),Object.assign(i,{_blur(e){e.blur()},_click(e){e.click()},_focus(e){e.focus()}}),Object.assign(i,{_triggerEvent(e,t,s){for(const i of this._parseEvents(t)){const t=this._parseEvent(i),n=new Event(t);s&&Object.assign(n,s),e.dispatchEvent(n)}}}),Object.assign(i,{_detach(e){e.parentNode&&e.parentNode.removeChild(e)}}),Object.assign(i,{_after(e,t){if(e.parentNode)for(const s of t.reverse())e.parentNode.insertBefore(s,e.nextSibling)},_append(e,t){for(const s of t)e.insertBefore(s,null)},_before(e,t){if(e.parentNode)for(const s of t)e.parentNode.insertBefore(s,e)},_prepend(e,t){for(const s of t.reverse())e.insertBefore(s,e.firstChild)}}),Object.assign(i,{isDocument:e=>t.isObject(e)&&"nodeType"in e&&e.nodeType===Node.DOCUMENT_NODE,isElement:e=>t.isObject(e)&&"nodeType"in e&&e.nodeType===Node.ELEMENT_NODE,isNode:e=>t.isObject(e)&&"nodeType"in e&&(e.nodeType===Node.ELEMENT_NODE||e.nodeType===Node.TEXT_NODE||e.nodeType===Node.COMMENT_NODE),_compareNodes(e,t){if(i._isSame(e,t))return 0;const s=e.compareDocumentPosition(t);return s&Node.DOCUMENT_POSITION_FOLLOWING||s&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:s&Node.DOCUMENT_POSITION_PRECEDING||s&Node.DOCUMENT_POSITION_CONTAINS?1:0},_has:(e,t)=>e.contains(t),_hasChildren:e=>!!e.childElementCount,_is:(e,t)=>e.matches(t),_isConnected:e=>e.isConnected,_isEqual:(e,t)=>e.isEqualNode(t),_isSame:(e,t)=>e.isSameNode(t),_isVisible:e=>t.isWindow(e)?"visible"===dom.context.visibilityState:i.isDocument(e)?"visible"===e.visibilityState:!!e.offsetParent,_normalize(e){e.normalize()}}),Object.assign(i,{parseHTML:e=>(new DOMParser).parseFromString(e,"text/html"),parseXML:e=>(new DOMParser).parseFromString(e,"application/xml")}),Object.assign(i,{_findByClass:(e,t)=>t.getElementsByClassName(e),_findById:(e,t)=>t.getElementById(e),_findByTag:(e,t)=>t.getElementsByTagName(e),_findBySelector:(e,t)=>t.querySelectorAll(e),_findOneBySelector:(e,t)=>t.querySelector(e),_findByCustom(e,t){const s=this._getAttribute(t,"id");this._setAttribute(t,{id:this.tempId});const i=this._findBySelector(e,t);return s?this._setAttribute(t,{id:s}):this._removeAttribute(t,"id"),i},_findOneByCustom(e,t){const s=this._getAttribute(t,"id");this._setAttribute(t,{id:this.tempId});const i=this._findOneBySelector(e,t);return s?this._setAttribute(t,{id:s}):this._removeAttribute(t,"id"),i}}),Object.assign(i,{_children(e,t,s=!1,i=!1){const n=i?e.children:e.childNodes,r=[];let o;for(o of n)if((!t||t(o))&&(r.push(o),s))break;return r},_parent(e,t){const s=[];return e.parentNode?t&&!t(e.parentNode)?s:(s.push(e.parentNode),s):s},_parents(e,t,s,i=!1){const n=[];for(;(e=e.parentNode)&&(!s||!s(e))&&(t&&!t(e)||(n.push(e),!i)););return n},_next(e,t){const s=[];for(;(e=e.nextSibling)&&!this.isElement(e););return e?t&&!t(e)?s:(s.push(e),s):s},_nextAll(e,t,s,i=!1){const n=[];for(;e=e.nextSibling;)if(this.isElement(e)){if(s&&s(e))break;if((!t||t(e))&&(n.push(e),i))break}return n},_prev(e,t){const s=[];for(;(e=e.previousSibling)&&!this.isElement(e););return e?t&&!t(e)?s:(s.push(e),s):s},_prevAll(e,t,s,i=!1){const n=[];for(;e=e.previousSibling;)if(this.isElement(e)){if(s&&s(e))break;if((!t||t(e))&&(n.push(e),i))break}return n},_siblings(e,t,s=!0){const n=[];if(!e.parentNode)return n;const r=s?e.parentNode.children:e.parentNode.childNodes;let o;for(o of r)i._isSame(e,o)||t&&!t(o)||n.push(o);return n}}),Object.assign(i,{_parseClasses:e=>e.flat().flatMap(e=>e.split(" ")),_parseData:(e,s)=>t.isObject(e)?e:{[e]:s},_parseEvent:e=>e.split(".").shift(),_parseEvents:e=>e.split(" "),_parseFormData(e){const t=new FormData;if(Array.isArray(e)){const t={};for(const s of e)t[s.name]=s.value;e=t}return this._parseFormValues(e,t),t},_parseFormValues(e,s,i){let n;for(n in e){const r=e[n];if(i&&(n=`${i}[${n}]`),t.isPlainObject(r))this._parseFormValues(r,s,n);else if(Array.isArray(r))for(const e of r)s.append(n,e);else s.set(n,r)}},_parseParams(e){let s=[];return Array.isArray(e)?s=e.map(e=>this._parseParam(e.name,e.value)):t.isObject(e)&&(s=Object.keys(e).map(t=>this._parseParam(t,e[t]))),s.flatMap(encodeURI).join("&")},_parseParam(e,s){return Array.isArray(s)?s.map(t=>this._parseParam(e,t)).flat():t.isObject(s)?Object.keys(s).map(t=>this._parseParam(e+"["+t+"]",s[t])).flat():e+"="+s},_prefixSelectors(e,t){return e.split(this.splitRegex).filter(e=>!!e).map(e=>`${t} ${e}`).join(", ")}}),Object.assign(i.prototype,{mouseDragFactory(s,i,n,r=!0){return i&&r&&(i=t.animationFactory(i),n&&(n=t.animationFactory(n))),t=>{if(s&&!1===s(t))return!1;i&&this._addEvent(e,"mousemove",i),(i||n)&&this._addEventOnce(e,"mouseup",t=>{i&&this._removeEvent(e,"mousemove",i),n&&n(t)})}},_delegateFactory(e,t,s){const n=t.match(i.complexRegex)?this._getDelegateContainsFactory(e,t):this._getDelegateMatchFactory(e,t);return t=>{if(i._isSame(t.target,e))return;const r=n(t.target);return r?(t.delegateTarget=r,s(t)):void 0}},_getDelegateContainsFactory:(e,s)=>(s=i._prefixSelectors(selectors,`#${i._tempId}`),n=>{const r=t.merge([],i._findByCustom(s,e));return!!r.length&&(r.includes(n)?n:i._parents(n,e=>r.contains(e),t=>i._isSame(e,t),!0).shift())}),_getDelegateMatchFactory:(e,t)=>s=>i._is(s,t)?s:i._parents(s,e=>i._is(e,t),t=>i._isSame(e,t),!0).shift(),_selfDestructFactory(e,t,s,i){const n=r=>(s?this._removeEvent(e,t,i,s):this._removeEvent(e,t,n),i(r));return n}}),Object.assign(i.prototype,{_parseFilter(e){return!!e&&(t.isFunction(e)?e:t.isString(e)?t=>i.isElement(t)&&i._is(t,e):i.isNode(e)?t=>i._isSame(t,e):!!(e=this._nodeFilter(e)).length&&(t=>e.includes(t)))},_parseFilterContains(e){return!!e&&(t.isFunction(e)?e:t.isString(e)?t=>!!this.findOne(e,t):i.isElement(e)?t=>i._has(t,e):!!(e=this._nodeFilter(e)).length&&(t=>!!e.find(e=>i._has(t,e))))}}),Object.assign(i.prototype,{sortNodes(e){return this._nodeFilter(e,i.isNode).sort(i._compareNodes)},_nodeFilter(e,s=i.isElement){return t.isString(e)?this.find(e).filter(s):s(e)?[e]:t.wrap(e).filter(s)},_nodeFind(e,s=i.isElement){if(t.isString(e)){const t=this.findOne(e);return s(t)?t:null}const n=t.wrap(e).shift();return s(n)?n:null},_parseQuery(e="*",s=i.isElement){return t.isString(e)&&"<"===e.trim().charAt(0)?this.parseHTML(e):this._nodeFilter(e,s)}}),Object.assign(i.prototype,{parseHTML(e){return t.merge([],this.context.createRange().createContextualFragment(e).childNodes)}}),Object.assign(i,{ajaxDefaults:{beforeSend:!1,cache:!0,contentType:"application/x-www-form-urlencoded",data:!1,method:"GET",processData:!0},animationDefaults:{duration:1e3,type:"ease-in-out",infinite:!1},cssNumberProperties:["font-weight","line-height","opacity","orphans","widows","z-index"],complexRegex:/(?:^\s*[\>\+\~]|\,(?=(?:(?:[^"']*["']){2})*[^"']*$)\s*[\>\+\~])/,fastRegex:/^([\#\.]?)([\w\-]+)$/,splitRegex:/\,(?=(?:(?:[^"]*"){2})*[^"]*$)\s*/,tempId:"frost"+Date.now().toString(16)}),{DOM:i,dom:new i}});