!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=e:Object.assign(t,e(t))}(this,(function(t){"use strict";if(!t)throw new Error("FrostDOM requires a Window.");if(!("Core"in t))throw new Error("FrostDOM requires FrostCore.");const e=t.Core,s=t.document;class r{constructor(s){if(this._settings=e.extend({},this.constructor.defaults,s),this._settings.url||(this._settings.url=t.location),!this._settings.cache){const t=new URL(this._settings.url);t.searchParams.append("_",Date.now()),this._settings.url=t.toString()}!("Content-Type"in this._settings.headers)&&this._settings.contentType&&(this._settings.headers["Content-Type"]=this._settings.contentType),this._isLocal=this.constructor._localRegExp.test(location.protocol),this._isLocal||"X-Requested-With"in this._settings.headers||(this._settings.headers["X-Requested-With"]="XMLHttpRequest"),this._isResolved=!1,this._isRejected=!1,this._isCancelled=!1,this._promise=new Promise((t,e)=>{this._resolve=e=>{this._isResolved=!0,t(e)},this._reject=t=>{this._isRejected=!0,e(t)}}),this._build(),this._events(),this._send()}cancel(t="Request was cancelled"){this._isResolved||this._isRejected||this._isCancelled||(this._xhr.abort(),this._isCancelled=!0,this._settings.rejectOnCancel&&this._reject({status:this._xhr.status,xhr:this._xhr,reason:t}))}catch(t){return this._promise.catch(t)}finally(t){return this._promise.finally(t)}then(t,e){return this._promise.then(t,e)}}class o{constructor(){this.data={headers:{}}}open(t,e,s){this.data.method=t,this.data.url=e,this.data.async=s}send(t){if(this.data.body=t,this.responseType&&(this.data.responseType=this.responseType),this.forceError){if(this.onerror){const t=new Event("error");this.onerror(t)}}else this.onprogress&&setTimeout(t=>{const e=new Event("progress");e.loaded=500,e.total=1e3,this.onprogress(e)},5),this.data.status=200,this.response="Test",this.onload&&setTimeout(t=>{const e=new Event("load");this.onload(e)},10)}setRequestHeader(t,e){this.data.headers[t]=e}}Object.assign(r.prototype,{_build(){this._xhr=this.constructor.useMock?new o:new XMLHttpRequest,this._xhr.open(this._settings.method,this._settings.url,!0);for(const t in this._settings.headers)this._xhr.setRequestHeader(t,this._settings.headers[t]);this._settings.responseType&&(this._xhr.responseType=this._settings.responseType)},_events(){this._xhr.onload=t=>{this._xhr.status>400?this._reject({status:this._xhr.status,xhr:this._xhr,event:t}):this._resolve({response:this._xhr.response,xhr:this._xhr,event:t})},this._isLocal||(this._xhr.onerror=t=>this._reject({status:this._xhr.status,xhr:this._xhr,event:t})),this._settings.onProgress&&(this._xhr.onprogress=t=>this._settings.onProgress(t.loaded/t.total,this._xhr,t)),this._settings.onUploadProgress&&(this._xhr.upload.onprogress=t=>this._settings.onUploadProgress(t.loaded/t.total,this._xhr,t))},_send(){this._settings.beforeSend&&this._settings.beforeSend(this._xhr),this._settings.data&&this._settings.processData&&("application/json"===this._settings.contentType?this._settings.data=JSON.stringify(this._settings.data):"application/x-www-form-urlencoded"===this._settings.contentType?this._settings.data=this.constructor._parseParams(this._settings.data):this._settings.data=this.constructor._parseFormData(this._settings.data)),this._xhr.send(this._settings.data),this._settings.afterSend&&this._settings.afterSend(this._xhr)}}),Object.assign(r,{_parseFormData(t){const s=new FormData;if(e.isArray(t)){const e={};for(const s of t)e[s.name]=s.value;t=e}return this._parseFormValues(t,s),s},_parseFormValues(t,s,r){let o;for(o in t){const n=t[o];if(r&&(o=`${r}[${o}]`),e.isPlainObject(n))this._parseFormValues(n,s,o);else if(e.isArray(n))for(const t of n)s.append(o,t);else s.set(o,n)}},_parseParam(t,s){if(e.isArray(s)){const e=[];for(const r of s)e.push(this._parseParam(t,r));return e.flat()}if(e.isObject(s)){const t=[];for(const e in s)t.push(this._parseParam(`${e}[${subKey}]`,s[subKey]));return t.flat()}return`${t}=${s}`},_parseParams(t){const s=[];if(e.isArray(t))for(const e of t)s.push(this._parseParam(e.name,e.value));else if(e.isObject(t))for(const e in t)s.push(this._parseParam(e,t[e]));const r=s.flat().join("&");return encodeURI(r)}}),Object.assign(r,{defaults:{afterSend:!1,beforeSend:!1,cache:!0,contentType:"application/x-www-form-urlencoded",data:null,headers:{},method:"GET",onProgress:!1,onUploadProgress:!1,processData:!0,rejectOnCancel:!0,responseType:!1,url:!1},_localRegExp:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/}),Object.setPrototypeOf(r.prototype,Promise.prototype);class n{constructor(t=s){this._context=t}}Object.assign(n.prototype,{ajax:t=>new r(t),delete:(t,e)=>new r({url:t,method:"DELETE",...e}),get:(t,e)=>new r({url:t,...e}),patch:(t,e,s)=>new r({url:t,data:e,method:"PATCH",...s}),post:(t,e,s)=>new r({url:t,data:e,method:"POST",...s}),put:(t,e,s)=>new r({url:t,data:e,method:"PUT",...s}),upload:(t,e,s)=>new r({url:t,data:e,method:"POST",contentType:!1,...s})}),Object.assign(n.prototype,{loadScript:(e,s=!0)=>new r({url:e,cache:s}).then(e=>eval.call(t,e.response)),loadScripts:(e,s=!0)=>Promise.all(e.map(t=>new r({url:t,cache:s}))).then(e=>{for(const s of e)eval.call(t,s.response)})}),Object.assign(n.prototype,{loadStyle(t,e=!0){return new r({url:t,cache:e}).then(t=>i.insertBefore(this._context.head,this.create("style",{html:t.response})))},loadStyles(t,e=!0){return Promise.all(t.map(t=>new r({url:t,cache:e}))).then(t=>{for(const e of t)i.insertBefore(this._context.head,this.create("style",{html:e.response}))})}}),Object.assign(n.prototype,{getCookie(t){const e=this._context.cookie.split(";").find(e=>e.trimStart().substring(0,t.length)===t).trimStart();return e?decodeURIComponent(e.substring(t.length+1)):null},removeCookie(t,e){if(!t)return;let s=`${t}=;expires=Thu, 01 Jan 1970 00:00:00 UTC`;e&&(e.path&&(s+=`;path=${e.path}`),e.secure&&(s+=";secure")),this._context.cookie=s},setCookie(t,e,s){if(!t)return;let r=`${t}=${e}`;if(s){if(s.expires){const t=new Date;t.setTime(t.getTime()+1e3*s.expires),r+=`;expires=${t.toUTCString()}`}s.path&&(r+=`;path=${s.path}`),s.secure&&(r+=";secure")}this._context.cookie=r}}),Object.assign(n.prototype,{animate(t,e,s){const r=(t=this.parseNodes(t)).map(t=>this.constructor._animate(t,e,{...this.constructor.animationDefaults,...s}));return this.constructor._start(),Promise.all(r)},stop(t,e=!0){t=this.parseNodes(t);for(const s of t)this.constructor._stop(s,e)}}),Object.assign(n.prototype,{dropIn(t,e){return this.slideIn(t,{direction:"top",...e})},dropOut(t,e){return this.slideOut(t,{direction:"top",...e})},fadeIn(t,e){return this.animate(t,(t,e)=>i.setStyle(t,"opacity",e<1?e:""),e)},fadeOut(t,e){return this.animate(t,(t,e)=>i.setStyle(t,"opacity",e<1?1-e:""),e)},rotateIn(t,e){return this.animate(t,(t,e,s)=>i.setStyle(t,"transform",e<1?`rotate3d(${s.x}, ${s.y}, 0, ${(90-90*e)*(s.inverse?-1:1)}deg)`:""),{x:0,y:1,...e})},rotateOut(t,e){return this.animate(t,(t,e,s)=>i.setStyle(t,"transform",e<1?`rotate3d(${s.x}, ${s.y}, 0, ${90*e*(s.inverse?-1:1)}deg)`:""),{x:0,y:1,...e})},slideIn(t,s){return this.animate(t,(t,s,r)=>{if(1===s)return i.setStyle(t,"overflow",""),void(r.useGpu?i.setStyle(t,"transform",""):(i.setStyle(t,"margin-left",""),i.setStyle(t,"margin-top","")));const o=e.isFunction(r.direction)?r.direction():r.direction;let n,a,c;["top","bottom"].includes(o)?(n=r.useGpu?"Y":"margin-top",a=this.constructor._height(t),c="top"===o):(n=r.useGpu?"X":"margin-left",a=this.constructor._width(t),c="left"===o);const h=(a-a*s)*(c?-1:1);r.useGpu?i.setStyle(t,"transform",`translate${n}(${h}px)`):i.setStyle(t,n,`${h}px`)},{direction:"bottom",useGpu:!0,...s})},slideOut(t,s){return this.animate(t,(t,s,r)=>{if(1===s)return i.setStyle(t,"overflow",""),void(r.useGpu?i.setStyle(t,"transform",""):(i.setStyle(t,"margin-left",""),i.setStyle(t,"margin-top","")));const o=e.isFunction(r.direction)?r.direction():r.direction;let n,a,c;["top","bottom"].includes(o)?(n=r.useGpu?"Y":"margin-top",a=this.constructor._height(t),c="top"===o):(n=r.useGpu?"X":"margin-left",a=this.constructor._width(t),c="left"===o);const h=a*s*(c?-1:1);r.useGpu?i.setStyle(t,"transform",`translate${n}(${h}px)`):i.setStyle(t,n,`${h}px`)},{direction:"bottom",useGpu:!0,...s})},squeezeIn(t,s){t=this.parseNodes(t),s={...this.constructor.animationDefaults,direction:"bottom",useGpu:!0,...s};const r=t.map(t=>{const r=i.getStyle(t,"height"),o=i.getStyle(t,"width");return i.setStyle(t,"overflow","hidden"),this.constructor._animate(t,(t,s,a)=>{if(i.setStyle(t,"height",r),i.setStyle(t,"width",o),1===s)return i.setStyle(t,"overflow",""),void(a.useGpu?i.setStyle(t,"transform",""):(i.setStyle(t,"margin-left",""),i.setStyle(t,"margin-top","")));const c=e.isFunction(a.direction)?a.direction():a.direction;let h,l;["top","bottom"].includes(c)?(h="height","top"===c&&(l=a.useGpu?"Y":"margin-top")):(h="width","left"===c&&(l=a.useGpu?"X":"margin-left"));const d=n[`_${h}`](t),u=d*s;if(i.setStyle(t,h,`${u}px`),l){const e=d-u;a.useGpu?i.setStyle(t,"transform",`translate${l}(${e}px)`):i.setStyle(t,l,`${e}px`)}},s)});return this.constructor._start(),Promise.all(r)},squeezeOut(t,s){t=this.parseNodes(t),s={...this.constructor.animationDefaults,direction:"bottom",useGpu:!0,...s};const r=t.map(t=>{const r=i.getStyle(t,"height"),o=i.getStyle(t,"width");return i.setStyle(t,"overflow","hidden"),this.constructor._animate(t,(t,s,a)=>{if(i.setStyle(t,"height",r),i.setStyle(t,"width",o),1===s)return i.setStyle(t,"overflow",""),void(a.useGpu?i.setStyle(t,"transform",""):(i.setStyle(t,"margin-left",""),i.setStyle(t,"margin-top","")));const c=e.isFunction(a.direction)?a.direction():a.direction;let h,l;["top","bottom"].includes(c)?(h="height","top"===c&&(l=a.useGpu?"Y":"margin-top")):(h="width","left"===c&&(l=a.useGpu?"X":"margin-left"));const d=n[`_${h}`](t),u=d-d*s;if(i.setStyle(t,h,`${u}px`),l){const e=d-u;a.useGpu?i.setStyle(t,"transform",`translate${l}(${e}px)`):i.setStyle(t,l,`${e}px`)}},s)});return this.constructor._start(),Promise.all(r)}}),Object.assign(n.prototype,{clearQueue(t){t=this.parseNodes(t);for(const e of t)this.constructor._clearQueue(e)},queue(t,e){t=this.parseNodes(t);for(const s of t)this.constructor._queue(s,e)}}),Object.assign(n.prototype,{getAttribute(t,e){const s=this.parseNode(t);if(s)return this.constructor._getAttribute(s,e)},getDataset(t,e){const s=this.parseNode(t);if(s)return this.constructor._getDataset(s,e)},getHTML(t){return this.getProperty(t,"innerHTML")},getProperty(t,e){const s=this.parseNode(t);if(s)return i.getProperty(s,e)},getText(t){return this.getProperty(t,"innerText")},getValue(t){return this.getProperty(t,"value")},removeAttribute(t,e){t=this.parseNodes(t);for(const s of t)i.removeAttribute(s,e)},removeDataset(t,e){t=this.parseNodes(t);for(const s of t)this.constructor._removeDataset(s,e)},removeProperty(t,e){t=this.parseNodes(t);for(const s of t)i.removeProperty(s,e)},setAttribute(t,e,s){t=this.parseNodes(t);const r=this.constructor._parseData(e,s);for(const e of t)this.constructor._setAttribute(e,r)},setDataset(t,e,s){t=this.parseNodes(t);const r=this.constructor._parseData(e,s,!0);for(const e of t)this.constructor._setDataset(e,r)},setHTML(t,e){this.empty(t),this.setProperty(t,"innerHTML",e)},setProperty(t,e,s){t=this.parseNodes(t);const r=this.constructor._parseData(e,s);for(const e of t)for(const t in r)i.setProperty(e,t,r[t])},setText(t,e){this.empty(t),this.setProperty(t,"innerText",e)},setValue(t,e){this.setProperty(t,"value",e)}}),Object.assign(n.prototype,{cloneData(t,e){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0,window:!0}),e=this.parseNodes(e,{fragment:!0,shadow:!0,document:!0,window:!0});for(const s of t)for(const t of e)this.constructor._cloneData(s,t)},getData(t,e){const s=this.parseNode(t,{fragment:!0,shadow:!0,document:!0,window:!0});if(s)return this.constructor._getData(s,e)},removeData(t,e){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0,window:!0});for(const s of t)this.constructor._removeData(s,e)},setData(t,e,s){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0,window:!0});const r=this.constructor._parseData(e,s);for(const e of t)this.constructor._setData(e,r)}}),Object.assign(n.prototype,{center(t,e){const s=this.rect(t,e);if(s)return{x:s.left+s.width/2,y:s.top+s.height/2}},constrain(t,e){const s=this.rect(e);if(s){t=this.parseNodes(t);for(const e of t)this.constructor._constrain(e,s)}},distTo(t,s,r,o){const n=this.center(t,o);if(n)return e.dist(n.x,n.y,s,r)},distToNode(t,e){const s=this.center(e);if(s)return this.distTo(t,s.x,s.y)},nearestTo(t,e,s,r){let o,n=Number.MAX_VALUE;t=this.parseNodes(t);for(const i of t){const t=this.distTo(i,e,s,r);t&&t<n&&(n=t,o=i)}return o},nearestToNode(t,e){const s=this.center(e);if(s)return this.nearestTo(t,s.x,s.y)},percentX(t,s,r,o=!0){const n=this.rect(t,r);if(!n)return;const i=(s-n.left)/n.width*100;return o?e.clampPercent(i):i},percentY(t,s,r,o=!0){const n=this.rect(t,r);if(!n)return;const i=(s-n.top)/n.height*100;return o?e.clampPercent(i):i},position(t,e){const s=this.parseNode(t);if(s)return this.constructor._position(s,e)},rect(t,e){const s=this.parseNode(t);if(s)return this.constructor._rect(s,e)}}),Object.assign(n.prototype,{getScrollX(t){const s=this.parseNode(t,{document:!0,window:!0});if(s)return e.isWindow(s)?i.getScrollXWindow(s):e.isDocument(s)?this.constructor._getScrollXDocument(s):i.getScrollX(s)},getScrollY(t){const s=this.parseNode(t,{document:!0,window:!0});if(s)return e.isWindow(s)?i.getScrollYWindow(s):e.isDocument(s)?this.constructor._getScrollYDocument(s):i.getScrollY(s)},setScroll(t,s,r){t=this.parseNodes(t,{document:!0,window:!0});for(const o of t)e.isWindow(o)?i.setScrollWindow(o,s,r):e.isDocument(o)?this.constructor._setScrollDocument(o,s,r):this.constructor._setScroll(o,s,r)},setScrollX(t,s){t=this.parseNodes(t,{document:!0,window:!0});for(const r of t)e.isWindow(r)?this.constructor._setScrollXWindow(r,s):e.isDocument(r)?this.constructor._setScrollXDocument(r,s):i.setScrollX(r,s)},setScrollY(t,s){t=this.parseNodes(t,{document:!0,window:!0});for(const r of t)e.isWindow(r)?this.constructor._setScrollYWindow(r,s):e.isDocument(r)?this.constructor._setScrollYDocument(r,s):i.setScrollY(r,s)}}),Object.assign(n.prototype,{height(t,s){const r=this.parseNode(t,{document:!0,window:!0});if(r)return e.isWindow(r)?i.heightWindow(r,e.isUndefined(s)?0:s):(e.isUndefined(s)&&(s=1),e.isDocument(r)?this.constructor._height(i.documentElement(r),s):this.constructor._height(r,s))},width(t,s){const r=this.parseNode(t,{document:!0,window:!0});if(r)return e.isWindow(r)?i.widthWindow(r,e.isUndefined(s)?0:s):(e.isUndefined(s)&&(s=1),e.isDocument(r)?this.constructor._width(i.documentElement(r),s):this.constructor._width(r,s))}}),Object.assign(n.prototype,{addClass(t,...e){if(t=this.parseNodes(t),(e=this.constructor._parseClasses(e)).length)for(const s of t)i.addClass(s,...e)},css(t,e){const s=this.parseNode(t);if(s)return this.constructor._css(s,e)},getStyle(t,e){const s=this.parseNode(t);if(s)return this.constructor._getStyle(s,e)},hide(t){this.setStyle(t,"display","none")},removeClass(t,...e){if(t=this.parseNodes(t),(e=this.constructor._parseClasses(e)).length)for(const s of t)i.removeClass(s,...e)},setStyle(t,e,s,r){t=this.parseNodes(t);const o=this.constructor._parseData(e,s);for(const e of t)this.constructor._setStyle(e,o,r)},show(t){this.setStyle(t,"display","")},toggle(t){t=this.parseNodes(t);for(const e of t)"none"===i.getStyle(e,"display")?i.setStyle(e,"display",""):i.setStyle(e,"display","none")},toggleClass(t,...e){if(t=this.parseNodes(t),(e=this.constructor._parseClasses(e)).length)for(const s of t)for(const t of e)i.toggleClass(s,t)}}),Object.assign(n.prototype,{mouseDragFactory(s,r,o,n=!0){return r&&n&&(r=e.animation(r),o&&(o=e.animation(o))),e=>{if(s&&!1===s(e))return!1;r&&this.addEvent(t,"mousemove",r),(r||o)&&this.addEvent(t,"mouseup",e=>{r&&this.removeEvent(t,"mousemove",r),o&&o(e)},!1,!0)}}}),Object.assign(n.prototype,{blur(t){const e=this.parseNode(t);e&&i.blur(e)},click(t){const e=this.parseNode(t);e&&i.click(e)},focus(t){const e=this.parseNode(t);e&&i.focus(e)},ready(e){"complete"!==this._context.readyState?this.constructor._addEvent(t,"DOMContentLoaded",e):e()}}),Object.assign(n.prototype,{addEvent(t,e,s,r,o){t=this.parseNodes(t,{shadow:!0,document:!0,window:!0});for(const n of t)for(const t of this.constructor._parseEvents(e))this.constructor._addEvent(n,t,s,r,o)},addEventDelegate(t,e,s,r){this.addEvent(t,e,r,s)},addEventDelegateOnce(t,e,s,r){this.addEvent(t,e,r,s,!0)},addEventOnce(t,e,s){this.addEvent(t,e,s,null,!0)},cloneEvents(t,e){t=this.parseNodes(t,{shadow:!0,document:!0,window:!0}),e=this.parseNodes(e,{shadow:!0,document:!0,window:!0});for(const s of t)for(const t of e)this.constructor._cloneEvents(s,t)},removeEvent(t,e,s,r){t=this.parseNodes(t,{shadow:!0,document:!0,window:!0}),e=!!e&&this.constructor._parseEvents(e);for(const o of t)if(this.constructor._events.has(o))if(e)for(const t of e)this.constructor._removeEvent(o,t,s,r);else this.constructor._removeEvent(o,e,s,r)},removeEventDelegate(t,e,s,r){this.removeEvent(t,e,r,s)},triggerEvent(t,e,s,r){t=this.parseNodes(t,{shadow:!0,document:!0,window:!0}),e=this.constructor._parseEvents(e);for(const o of t)for(const t of e)this.constructor._triggerEvent(o,t,s,r)}}),Object.assign(n.prototype,{attachShadow(t,e=!0){const s=this.parseNode(t);if(s)return i.attachShadow(s,e)},create(t="div",s){const r=i.create(this._context,t);if(!s)return r;if("html"in s?i.setProperty(r,"innerHTML",s.html):"text"in s&&i.setProperty(r,"innerText",s.text),"class"in s&&i.addClass(r,...this.constructor._parseClasses(e.wrap(s.class))),"style"in s&&this.constructor._setStyle(r,s.style),"value"in s&&i.setProperty(r,"value",s.value),"attributes"in s&&this.constructor._setAttribute(r,s.attributes),"properties"in s)for(const t in s.properties)i.setProperty(r,t,s.properties[t]);if("dataset"in s){const t=this.constructor._parseData(s.dataset,null,!0);this.constructor._setDataset(r,t)}return r},createComment(t){return i.createComment(this._context,t)},createFragment(){return i.createFragment(this._context)},createRange(){return i.createRange(this._context)},createText(t){return i.createText(this._context,t)},parseHTML(t){return e.wrap(i.children(this.createRange().createContextualFragment(t)))}}),Object.assign(n.prototype,{clone(t,e=!0,s=!1,r=!1){return(t=this.parseNodes(t,{node:!0,fragment:!0})).map(t=>this.constructor._clone(t,e,s,r))},detach(t){t=this.parseNodes(t,{node:!0});for(const e of t){const t=i.parent(e);t&&i.removeChild(t,e)}return t},empty(t){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0});for(const e of t)this.constructor._empty(e)},remove(t){t=this.parseNodes(t,{node:!0});for(const e of t){const t=i.parent(e);t&&(this.constructor._remove(e),i.removeChild(t,e))}},replaceAll(t,e){this.replaceWith(e,t)},replaceWith(t,e){t=this.parseNodes(t,{node:!0});const s=(e=this.parseNodes(e,{node:!0,fragment:!0,html:!0})).map(t=>this.constructor._clone(t,!0));for(const e of t)this.constructor._replaceWith(e,s)}}),Object.assign(n.prototype,{after(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseNodes(e,{node:!0,fragment:!0,html:!0}).reverse();const s=t.slice(-1).pop();for(const r of t){const t=i.parent(r);if(t)for(const o of e)i.insertBefore(t,i.isSame(r,s)?o:i.clone(o,!0),i.next(r))}},append(t,e){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}),e=this.parseNodes(e,{node:!0,fragment:!0,html:!0});const s=t.slice(-1).pop();for(const r of t)for(const t of e)i.insertBefore(r,i.isSame(r,s)?t:i.clone(t,!0))},appendTo(t,e){this.append(e,t)},before(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseNodes(e,{node:!0,fragment:!0,html:!0});const s=t.slice(-1).pop();for(const r of t){const t=i.parent(r);if(t)for(const o of e)i.insertBefore(t,i.isSame(r,s)?o:i.clone(o,!0),r)}},insertAfter(t,e){this.after(e,t)},insertBefore(t,e){this.before(e,t)},prepend(t,e){t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}),e=this.parseNodes(e,{node:!0,fragment:!0,html:!0});const s=t.slice(-1).pop();for(const r of t){const t=i.firstChild(r);for(const o of e)i.insertBefore(r,i.isSame(r,s)?o:i.clone(o,!0),t)}},prependTo(t,e){this.prepend(e,t)}}),Object.assign(n.prototype,{unwrap(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseFilter(e);const s=[];for(const r of t){const t=i.parent(r);t&&(s.includes(t)||e&&!e(t)||s.push(t))}for(const t of s)this.constructor._unwrap(t)},wrap(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseNodes(e,{fragment:!0,html:!0});for(const s of t)this.constructor._wrap(s,e)},wrapAll(t,e){t=this.parseNodes(t,{node:!0}),e=this.parseNodes(e,{fragment:!0,html:!0});const s=this.clone(e,!0);this.constructor._wrapAll(t,s)},wrapInner(t,e){t=this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}),e=this.parseNodes(e,{fragment:!0,html:!0});for(const s of t)this.constructor._wrapInner(s,e)}}),Object.assign(n.prototype,{connected(t){return this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter(t=>i.isConnected(t))},equal(t,e){return e=this.parseNodes(e,{node:!0,fragment:!0,shadow:!0}),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter(t=>e.some(e=>i.isEqual(t,e)))},filter(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter((t,s)=>!e||e(t,s))},filterOne(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).find((t,s)=>!e||e(t,s))||null},fixed(t){return this.parseNodes(t,{node:!0}).filter(t=>e.isElement(t)&&"fixed"===this.constructor._css(t,"position")||this.constructor._parents(t,t=>e.isElement(t)&&"fixed"===this.constructor._css(t,"position"),!1,!0).length)},hidden(t){return this.parseNodes(t,{node:!0,document:!0,window:!0}).filter(t=>!this.constructor._isVisible(t))},not(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter((t,s)=>e&&!e(t,s))},notOne(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).find((t,s)=>e&&!e(t,s))||null},same(t,e){return e=this.parseNodes(e,{node:!0,fragment:!0,shadow:!0}),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).filter(t=>e.some(e=>i.isSame(t,e)))},visible(t){return this.parseNodes(t,{node:!0,document:!0,window:!0}).filter(t=>this.constructor._isVisible(t))},withAnimation(t){return this.parseNodes(t).filter(t=>this.constructor._hasAnimation(t))},withAttribute(t,e){return this.parseNodes(t).filter(t=>i.hasAttribute(t,e))},withChildren(t){return this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}).filter(t=>i.hasChildren(t))},withClass(t,...e){return e=this.constructor._parseClasses(e),this.parseNodes(t).filter(t=>e.some(e=>i.hasClass(t,e)))},withCSSAnimation(t){return this.parseNodes(t).filter(t=>this.constructor._hasCSSAnimation(t))},withCSSTransition(t){return this.parseNodes(t).filter(t=>this.constructor._hasCSSTransition(t))},withData(t,e){return this.parseNodes(t,{node:!0,fragment:!0,shadow:!0,document:!0,window:!0}).filter(t=>this.constructor._hasData(t,e))},withDescendent(t,e){return e=this.parseFilterContains(e),this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}).filter((t,s)=>!e||e(t,s))},withProperty(t,e){return this.parseNodes(t).filter(t=>i.hasProperty(t,e))}}),Object.assign(n.prototype,{find(t,s=this._context){const r=t.match(this.constructor._fastRegExp);return r?"#"===r[1]?this.findById(r[2],s):"."===r[1]?this.findByClass(r[2],s):this.findByTag(r[2],s):(t.match(this.constructor._complexRegExp)&&(t=this.constructor._prefixSelectors(t,":scope ")),e.isDocument(s)||e.isElement(s)||e.isFragment(s)||e.isShadow(s)?e.wrap(i.findBySelector(t,s)):(s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0}),this.constructor._findBySelector(t,s)))},findByClass(t,s=this._context){if(e.isDocument(s)||e.isElement(s)||e.isFragment(s)||e.isShadow(s))return e.wrap(i.findByClass(t,s));s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0});const r=[];for(const o of s)e.merge(r,i.findByClass(t,o));return s.length>1&&r.length>1?e.unique(r):r},findById(t,e=this._context){return e=this.parseNodes(e,{fragment:!0,shadow:!0,document:!0}),this.constructor._findBySelector(`#${t}`,e)},findByTag(t,s=this._context){if(e.isDocument(s)||e.isElement(s)||e.isFragment(s)||e.isShadow(s))return e.wrap(i.findByTag(t,s));s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0});const r=[];for(const o of s)e.merge(r,i.findByTag(t,o));return s.length>1&&r.length>1?e.unique(r):r},findOne(t,s=this._context){const r=t.match(this.constructor._fastRegExp);return r?"#"===r[1]?this.findOneById(r[2],s):"."===r[1]?this.findOneByClass(r[2],s):this.findOneByTag(r[2],s):(t.match(this.constructor._complexRegExp)&&(t=this.constructor._prefixSelectors(t,":scope ")),e.isDocument(s)||e.isElement(s)||e.isFragment(s)||e.isShadow(s)?i.findOneBySelector(t,s):(s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0})).length?this.constructor._findOneBySelector(t,s):void 0)},findOneByClass(t,s=this._context){if(e.isDocument(s)||e.isElement(s)||e.isFragment(s)||e.isShadow(s))return i.findByClass(t,s).item(0);if((s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0})).length){for(const e of s){const s=i.findByClass(t,e).item(0);if(s)return s}return null}},findOneById(t,s=this._context){return e.isDocument(s)?i.findById(t,s):(s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0})).length?this.constructor._findOneBySelector(`#${t}`,s):void 0},findOneByTag(t,s=this._context){if(e.isDocument(s)||e.isElement(s)||e.isFragment(s)||e.isShadow(s))return i.findByTag(t,s).item(0);if((s=this.parseNodes(s,{fragment:!0,shadow:!0,document:!0})).length){for(const e of s){const s=i.findByTag(t,e).item(0);if(s)return s}return null}}}),Object.assign(n.prototype,{child(t,e){return this.children(t,e,!0)},children(t,s,r=!1,o=!0){if(s=this.parseFilter(s),e.isElement(t)||e.isDocument(t)||e.isFragment(t)||e.isShadow(t))return this.constructor._children(t,s,r,o);t=this.parseNodes(t,{fragment:!0,shadow:!0,document:!0});const n=[];for(const i of t)e.merge(n,this.constructor._children(i,s,r,o));return t.length>1&&n.length>1?e.unique(n):n},closest(t,e,s){return this.parents(t,e,s,!0)},commonAncestor(t){if(!(t=this.sort(t)).length)return;const e=this.createRange();return 1===t.length?i.select(e,t.shift()):(i.setStartBefore(e,t.shift()),i.setEndAfter(e,t.pop())),e.commonAncestorContainer},contents(t){return this.children(t,!1,!1,!1)},fragment(t){const e=this.parseNode(t);if(e)return i.fragment(e)},next(t,s){if(s=this.parseFilter(s),e.isNode(t))return this.constructor._next(t,s);t=this.parseNodes(t,{node:!0});const r=[];for(const o of t)e.merge(r,this.constructor._next(o,s));return t.length>1&&r.length>1?e.unique(r):r},nextAll(t,s,r,o=!1){if(s=this.parseFilter(s),r=this.parseFilter(r),e.isNode(t))return this.constructor._nextAll(t,s,r,o);t=this.parseNodes(t,{node:!0});const n=[];for(const i of t)e.merge(n,this.constructor._nextAll(i,s,r,o));return t.length>1&&n.length>1?e.unique(n):n},offsetParent(t){return this.forceShow(t,t=>i.offsetParent(t))},parent(t,s){if(s=this.parseFilter(s),e.isNode(t))return this.constructor._parent(t,s);t=this.parseNodes(t,{node:!0});const r=[];for(const o of t)e.merge(r,this.constructor._parent(o,s));return t.length>1&&r.length>1?e.unique(r):r},parents(t,s,r,o=!1){if(s=this.parseFilter(s),r=this.parseFilter(r),e.isNode(t))return this.constructor._parents(t,s,r,o);t=this.parseNodes(t,{node:!0});const n=[];for(const i of t)e.merge(n,this.constructor._parents(i,s,r,o));return t.length>1&&n.length>1?e.unique(n):n},prev(t,s){if(s=this.parseFilter(s),e.isNode(t))return this.constructor._prev(t,s);t=this.parseNodes(t,{node:!0});const r=[];for(const o of t)e.merge(r,this.constructor._prev(o,s));return t.length>1&&r.length>1?e.unique(r):r},prevAll(t,s,r,o=!1){if(s=this.parseFilter(s),r=this.parseFilter(r),e.isNode(t))return this.constructor._prevAll(t,s,r,o);t=this.parseNodes(t,{node:!0});const n=[];for(const i of t)e.merge(n,this.constructor._prevAll(i,s,r,o));return t.length>1&&n.length>1?e.unique(n):n},shadow(t){const e=this.parseNode(t);if(e)return i.shadow(e)},siblings(t,s,r=!0){if(s=this.parseFilter(s),e.isNode(t))return this.constructor._siblings(t,s,r);t=this.parseNodes(t,{node:!0});const o=[];for(const n of t)e.merge(o,this.constructor._siblings(n,s,r));return t.length>1&&o.length>1?this.sort(e.unique(o)):o}}),Object.assign(n.prototype,{parseFilter(t){return!!t&&(e.isFunction(t)?t:e.isString(t)?e=>i.is(e,t):e.isNode(t)||e.isFragment(t)||e.isShadow(t)?e=>i.isSame(e,t):!!(t=this.parseNodes(t,{node:!0,fragment:!0,shadow:!0})).length&&(e=>t.includes(e)))},parseFilterContains(t){return!!t&&(e.isFunction(t)?s=>e.merge([],i.findBySelector("*",s)).some(t):e.isString(t)?e=>!!this.findOne(t,e):e.isNode(t)||e.isFragment(t)||e.isShadow(t)?e=>i.contains(e,t):!!(t=this.parseNodes(t,{node:!0,fragment:!0,shadow:!0})).length&&(e=>t.some(t=>i.contains(e,t))))},parseNode(t,s={}){if(e.isString(t)){if("html"in s&&s.html&&"<"===t.trim().charAt(0))return this.parseHTML(t).shift();const e=this.findOne(t,"context"in s?s.context:this._context);return e||null}const r=this.constructor.parseNodesFactory(s);if(r(t))return t;const o=e.wrap(t).slice().shift();return o&&r(o)?o:null},parseNodes(t,s={}){if(e.isString(t))return"html"in s&&s.html&&"<"===t.trim().charAt(0)?this.parseHTML(t):this.find(t,"context"in s?s.context:this._context);const r=this.constructor.parseNodesFactory(s);return r(t)?[t]:e.wrap(t).filter(r)}}),Object.assign(n.prototype,{afterSelection(t){t=this.parseNodes(t,{node:!0,fragment:!0,html:!0}).reverse();const e=i.getSelection();if(!i.rangeCount(e))return;const s=i.getRange(e);i.removeRanges(e),i.collapse(s);for(const e of t)i.insert(s,e)},beforeSelection(t){t=this.parseNodes(t,{node:!0,fragment:!0,html:!0}).reverse();const e=i.getSelection();if(!i.rangeCount(e))return;const s=i.getRange(e);i.removeRanges(e);for(const e of t)i.insert(s,e)},extractSelection(){const t=i.getSelection();if(!i.rangeCount(t))return[];const s=i.getRange(t);i.removeRanges(t);const r=i.extract(s);return e.wrap(i.childNodes(r))},getSelection(){const t=i.getSelection();if(!i.rangeCount(t))return[];const s=i.getRange(t),r=e.wrap(i.findBySelector("*",s.commonAncestorContainer));if(!r.length)return[s.commonAncestorContainer];if(1===r.length)return r;const o=i.startContainer(s),n=i.endContainer(s),a=e.isElement(o)?o:i.parent(o),c=e.isElement(n)?n:i.parent(n),h=r.slice(r.indexOf(a),r.indexOf(c)+1),l=[];let d;for(const t of h)d&&i.contains(d,t)||(d=t,l.push(t));return l},select(t){const e=this.parseNode(t,{node:!0,fragment:!0,shadow:!0});if(e&&"select"in e)return e.select();const s=i.getSelection();if(i.rangeCount(s)>0&&i.removeRanges(s),!e)return;const r=this.createRange();i.select(r,e),i.addRange(s,r)},selectAll(t){t=this.sort(t);const e=i.getSelection();if(i.rangeCount(e)&&i.removeRanges(e),!t.length)return;const s=this.createRange();1==t.length?i.select(s,t.shift()):(i.setStartBefore(s,t.shift()),i.setEndAfter(s,t.pop())),i.addRange(e,s)},wrapSelection(t){t=this.parseNodes(t,{fragment:!0,html:!0});const s=i.getSelection();if(!i.rangeCount(s))return;const r=i.getRange(s);i.removeRanges(s);const o=i.extract(r),n=this.constructor._deepest(t.slice().shift()),a=e.wrap(i.childNodes(o));for(const t of a)i.insertBefore(n,t);for(const e of t)i.insert(r,e)}}),Object.assign(n.prototype,{hasAnimation(t){return this.parseNodes(t).some(t=>this.constructor._hasAnimation(t))},hasAttribute(t,e){return this.parseNodes(t).some(t=>i.hasAttribute(t,e))},hasChildren(t){return this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}).some(t=>i.hasChildren(t))},hasClass(t,...e){return e=this.constructor._parseClasses(e),this.parseNodes(t).some(t=>e.some(e=>i.hasClass(t,e)))},hasCSSAnimation(t){return this.parseNodes(t).some(t=>this.constructor._hasCSSAnimation(t))},hasCSSTransition(t){return this.parseNodes(t).some(t=>this.constructor._hasCSSTransition(t))},hasData(t,e){return this.parseNodes(t,{fragment:!0,shadow:!0,document:!0,window:!0}).some(t=>this.constructor._hasData(t,e))},hasDescendent(t,e){return e=this.parseFilterContains(e),this.parseNodes(t,{fragment:!0,shadow:!0,document:!0}).some(t=>!e||e(t))},hasFragment(t){return this.parseNodes(t).some(t=>this.constructor._hasFragment(t))},hasProperty(t,e){return this.parseNodes(t).some(t=>i.hasProperty(t,e))},hasShadow(t){return this.parseNodes(t).some(t=>this.constructor._hasShadow(t))},is(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).some(t=>!e||e(t))},isConnected(t){return this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).some(t=>i.isConnected(t))},isEqual(t,e){return e=this.parseNodes(e,{node:!0,fragment:!0,shadow:!0}),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).some(t=>e.some(e=>i.isEqual(t,e)))},isFixed(t){return this.parseNodes(t,{node:!0}).some(t=>e.isElement(t)&&"fixed"===this.constructor._css(t,"position")||this.constructor._parents(t,t=>e.isElement(t)&&"fixed"===this.constructor._css(t,"position"),!1,!0).length)},isHidden(t){return this.parseNodes(t,{node:!0,document:!0,window:!0}).some(t=>!this.constructor._isVisible(t))},isSame(t,e){return e=this.parseNodes(e,{node:!0,fragment:!0,shadow:!0}),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).some(t=>e.some(e=>i.isSame(t,e)))},isVisible(t){return this.parseNodes(t,{node:!0,document:!0,window:!0}).some(t=>this.constructor._isVisible(t))}}),Object.assign(n.prototype,{exec(t,e=null){return this._context.execCommand(t,!1,e)},forceShow(t,e){const s=this.parseNode(t,{node:!0,document:!0,window:!0});if(s)return this.constructor._forceShow(s,e)},index(t){const s=this.parseNode(t,{node:!0});if(s)return e.wrap(i.children(i.parent(s))).indexOf(s)},indexOf(t,e){return e=this.parseFilter(e),this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).findIndex(t=>!e||e(t))},normalize(t){t=this.parseNodes(t,{node:!0,fragment:!0,shadow:!0,document:!0});for(const e of t)i.normalize(e)},sanitize(t,e=n.allowedTags){const s=this.create("template",{html:t}),r=i.fragment(s),o=this.constructor._children(r,null,!1,!0);for(const t of o)this.constructor._sanitize(t,r,e);return this.getHTML(s)},serialize(t){return r._parseParams(this.serializeArray(t))},serializeArray(t){return this.parseNodes(t,{fragment:!0,shadow:!0}).reduce((t,s)=>{if(i.is(s,"form")||e.isFragment(s)||e.isShadow(s))return t.concat(this.serializeArray(i.findBySelector("input, select, textarea",s)));if(i.is(s,"[disabled], input[type=submit], input[type=reset], input[type=file], input[type=radio]:not(:checked), input[type=checkbox]:not(:checked)"))return t;const r=i.getAttribute(s,"name");if(!r)return t;if(i.is(s,"select[multiple]")){const o=e.wrap(s.selectedOptions);for(const e of o){const s=i.getProperty(e,"value")||"";t.push({name:r,value:s})}}else{const e=i.getProperty(s,"value")||"";t.push({name:r,value:e})}return t},[])},sort(t){return this.parseNodes(t,{node:!0,fragment:!0,shadow:!0}).sort((t,e)=>{if(i.isSame(t,e))return 0;const s=i.comparePosition(t,e);return s&Node.DOCUMENT_POSITION_FOLLOWING||s&Node.DOCUMENT_POSITION_CONTAINED_BY?-1:s&Node.DOCUMENT_POSITION_PRECEDING||s&Node.DOCUMENT_POSITION_CONTAINS?1:0})},tagName(t){const e=this.parseNode(t);if(e)return this.constructor._tagName(e)}}),Object.assign(n,{_animate(t,s,r){n._hasAnimation(t)||this._animations.set(t,[]);const o=performance.now();return new Promise((n,i)=>{this._animations.get(t).push((a=!1,c=!1)=>{if(a&&!c)return i(t),!0;let h;return c?h=1:(h=(performance.now()-o)/r.duration,r.infinite?h%=1:h=e.clamp(h),"ease-in"===r.type?h=Math.pow(h,2):"ease-out"===r.type?h=Math.sqrt(h):"ease-in-out"===r.type&&(h=h<=.5?2*Math.pow(h,2):1-(1-h)**2*2)),s(t,h,r),1===h?(n(t),!0):void 0})})},_animationFrame(){for(let[t,e]of this._animations)e=e.filter(t=>!t()),e.length?this._animations.set(t,e):this._animations.delete(t);this._animations.size?t.requestAnimationFrame(t=>this._animationFrame()):this._animating=!1},_start(){this._animating||(this._animating=!0,this._animationFrame())},_stop(t,e=!0){if(!n._hasAnimation(t))return;const s=this._animations.get(t);for(const t of s)t(!0,e);this._animations.delete(t)}}),Object.assign(n,{_clearQueue(t){this._queues.has(t)&&this._queues.delete(t)},_dequeueNode(t){if(!this._queues.has(t))return;const e=this._queues.get(t).shift();e?Promise.resolve(e(t)).finally(e=>this._dequeueNode(t)):this._queues.delete(t)},_queue(t,e){const s=!this._queues.has(t);s&&this._queues.set(t,[]),this._queues.get(t).push(e),s&&this._dequeueNode(t)}}),Object.assign(n,{_getAttribute(t,e){if(e)return i.getAttribute(t,e);const s=i.attributes(t),r={};for(const t of s)r[t.nodeName]=t.nodeValue;return r},_getDataset(t,s){if(s)return s=e.camelCase(s),n._parseDataset(i.getDataset(t,s));const r=i.dataset(t),o={};for(const t in r)o[t]=n._parseDataset(r[t]);return o},_removeDataset(t,s){s=e.camelCase(s),i.removeDataset(t,s)},_setAttribute(t,e){for(const s in e)i.setAttribute(t,s,e[s])},_setDataset(t,s){for(const r in s){const o=e.camelCase(r);i.setDataset(t,o,s[r])}}}),Object.assign(n,{_cloneData(t,e){this._data.has(t)&&this._setData(e,{...this._data.get(t)})},_getData(t,e){if(this._data.has(t))return e?this._data.get(t)[e]:this._data.get(t)},_removeData(t,e){if(this._data.has(t)){if(e){const s=this._data.get(t);if(delete s[e],Object.keys(s).length)return}this._data.delete(t)}},_setData(t,e){this._data.has(t)||this._data.set(t,{}),Object.assign(this._data.get(t),e)}}),Object.assign(n,{_constrain(t,e){const s=this._rect(t),r={};let o,n;if(s.height>e.height&&(r.height=e.height),s.width>e.width&&(r.width=e.width),s.left-e.left<0?o=s.left-e.left:s.right-e.right>0&&(o=s.right-e.right),o){const e=this._css(t,"left"),s=e&&"auto"!==e?parseFloat(e):0;r.left=`${s-o}px`}if(s.top-e.top<0?n=s.top-e.top:s.bottom-e.bottom>0&&(n=s.bottom-e.bottom),n){const e=this._css(t,"top"),s=e&&"auto"!==e?parseFloat(e):0;r.top=`${s-n}px`}"static"===this._css(t,"position")&&(r.position="relative"),this._setStyle(t,r)},_position(t,e){return this._forceShow(t,t=>{const s={x:i.offsetLeft(t),y:i.offsetTop(t)};if(e){let e=t;for(;e=i.offsetParent(e);)s.x+=i.offsetLeft(e),s.y+=i.offsetTop(e)}return s})},_rect(e,s){return this._forceShow(e,e=>{const r=i.rect(e);return s&&(r.x+=i.getScrollXWindow(t),r.y+=i.getScrollYWindow(t)),r})}}),Object.assign(n,{_getScrollXDocument:t=>i.getScrollX(i.scrollingElement(t)),_getScrollYDocument:t=>i.getScrollY(i.scrollingElement(t)),_setScroll(t,e,s){i.setScrollX(t,e),i.setScrollY(t,s)},_setScrollDocument(t,e,s){return this._setScroll(i.scrollingElement(t),e,s)},_setScrollXDocument:(t,e)=>i.setScrollX(i.scrollingElement(t),e),_setScrollXWindow:(t,e)=>i.setScrollWindow(t,e,i.getScrollYWindow(t)),_setScrollYDocument:(t,e)=>i.setScrollY(i.scrollingElement(t),e),_setScrollYWindow:(t,e)=>i.setScrollWindow(t,i.getScrollXWindow(t),e)}),Object.assign(n,{_height(t,e=1){return this._forceShow(t,t=>{let s=i.height(t);return e===this.INNER&&(s-=parseInt(this._css(t,"padding-top"))+parseInt(this._css(t,"padding-bottom"))),e>=this.OUTER&&(s+=parseInt(this._css(t,"border-top-width"))+parseInt(this._css(t,"border-bottom-width"))),e===this.OUTER_MARGIN&&(s+=parseInt(this._css(t,"margin-top"))+parseInt(this._css(t,"margin-bottom"))),s})},_width(t,e=1){return this._forceShow(t,t=>{let s=i.width(t);return e===this.INNER&&(s-=parseInt(this._css(t,"padding-left"))+parseInt(this._css(t,"padding-right"))),e>=this.OUTER&&(s+=parseInt(this._css(t,"border-left-width"))+parseInt(this._css(t,"border-right-width"))),e===this.OUTER_MARGIN&&(s+=parseInt(this._css(t,"margin-left"))+parseInt(this._css(t,"margin-right"))),s})}}),Object.assign(n,{_css(t,s){return this._styles.has(t)||this._styles.set(t,i.css(t)),s?(s=e.kebabCase(s),this._styles.get(t).getPropertyValue(s)):{...this._styles.get(t)}},_getStyle(t,s){if(s)return s=e.kebabCase(s),i.getStyle(t,s);const r=i.style(t),o={};for(const e of r)o[e]=i.getStyle(t,e);return o},_setStyle(t,s,r){for(let o in s){let n=s[o];o=e.kebabCase(o),n&&e.isNumeric(n)&&!this.cssNumberProperties.includes(o)&&(n+="px"),i.setStyle(t,o,n,r)}}}),Object.assign(n,{_delegateFactory(t,s,r){const o=s.match(n._complexRegExp)?this._getDelegateContainsFactory(t,s):this._getDelegateMatchFactory(t,s);return s=>{if(i.isSame(s.target,t))return;const n=o(s.target);if(!n)return;const a={};for(const t in s)a[t]=e.isFunction(s[t])?(...e)=>s[t](...e):s[t];return a.currentTarget=n,a.delegateTarget=t,a.originalEvent=s,Object.freeze(a),r(a)}},_getDelegateContainsFactory(t,s){return s=n._prefixSelectors(s,":scope "),r=>{const o=e.wrap(i.findBySelector(s,t));return!!o.length&&(o.includes(r)?r:this._parents(r,t=>o.includes(t),e=>i.isSame(t,e),!0).shift())}},_getDelegateMatchFactory(t,e){return s=>i.is(s,e)?s:this._parents(s,t=>i.is(t,e),e=>i.isSame(t,e),!0).shift()},_namespaceFactory:(t,e)=>s=>{if(!("namespaceRegExp"in s)||s.namespaceRegExp.test(t))return e(s)},_selfDestructFactory(t,e,s,r){return o=>(s?this._removeEvent(t,e,r,s):this._removeEvent(t,e,r),r(o))}}),Object.assign(n,{_addEvent(t,e,s,r,o){this._events.has(t)||this._events.set(t,{});const n=this._events.get(t),a={delegate:r,callback:s,selfDestruct:o},c=this._parseEvent(e);let h=s;if(o&&(h=this._selfDestructFactory(t,e,r,h)),r&&(h=this._delegateFactory(t,r,h)),e!==c&&(h=this._namespaceFactory(e,h)),a.realCallback=h,a.event=e,a.realEvent=c,n[c]){if(n[c].includes(a))return}else n[c]=[];n[c].push(a),i.addEvent(t,c,h)},_cloneEvents(t,e){if(!this._events.has(t))return;const s=this._events.get(t);for(const t in s)for(const r of s[t])this._addEvent(e,r.event,r.callback,r.delegate,r.selfDestruct)},_removeEvent(t,e,s,r){if(!this._events.has(t))return;const o=this._events.get(t);if(!e){const e=Object.keys(o);for(const o of e)this._removeEvent(t,o,s,r);return}const a=this._parseEvent(e);o[a]&&(o[a]=o[a].filter(o=>{if(r&&r!==o.delegate||s&&s!==o.callback)return!0;if(a!==e){const t=n._eventNamespacedRegExp(e);if(!o.event.match(t))return!0}return i.removeEvent(t,o.realEvent,o.realCallback),!1}),o[a].length||delete o[a],Object.keys(o).length||this._events.delete(t))},_triggerEvent(t,e,s,r){const o=n._parseEvent(e),a={...s};return o!==e&&(a.namespace=e.substring(o.length+1),a.namespaceRegExp=n._eventNamespacedRegExp(e)),i.triggerEvent(t,o,a,r)}}),Object.assign(n,{_eventNamespacedRegExp:t=>new RegExp(`^${e.escapeRegExp(t)}(?:\\.|$)`,"i"),_parseClasses:t=>t.flat().flatMap(t=>t.split(" ")),_parseData(t,s,r=!1){const o=e.isObject(t)?t:{[t]:s},n={};for(const t in o){const s=o[t];n[t]=r&&(e.isObject(s)||e.isArray(s))?JSON.stringify(s):s}return n},_parseDataset(t){if(e.isUndefined(t))return t;const s=t.toLowerCase().trim();if(["true","on"].includes(s))return!0;if(["false","off"].includes(s))return!1;if("null"===s)return null;if(e.isNumeric(s))return parseFloat(s);if(["{","["].includes(s.charAt(0)))try{return JSON.parse(t)}catch(t){}return t},_parseEvent:t=>t.split(".").shift(),_parseEvents:t=>t.split(" "),_prefixSelectors(t,e){return t.split(this._splitRegExp).filter(t=>!!t).map(t=>`${e} ${t}`).join(", ")}}),Object.assign(n,{_clone(t,e=!0,s=!1,r=!1){const o=i.clone(t,e);return s||r?(s&&this._cloneEvents(t,o),r&&this._cloneData(t,o),e&&this._deepClone(t,o,s,r),o):o},_deepClone(t,s,r=!1,o=!1){const n=e.wrap(i.childNodes(t)),a=e.wrap(i.childNodes(s));for(let t=0;t<n.length;t++)r&&this._cloneEvents(n[t],a[t]),o&&this._cloneData(n[t],a[t]),this._deepClone(n[t],a[t])},_detach(t){const e=i.parent(t);e||i.removeChild(e,t)},_empty(t){const s=e.wrap(i.childNodes(t));for(const e of s)this._remove(e),i.removeChild(t,e);if(this._hasShadow(t)){const e=i.shadow(t);this._remove(e)}if(this._hasFragment(t)){const e=i.fragment(t);this._remove(e)}},_remove(t){i.triggerEvent(t,"remove"),this._empty(t),e.isElement(t)&&(this._clearQueue(t),this._stop(t),this._styles.has(t)&&this._styles.delete(t)),this._removeEvent(t),this._removeData(t)},_replaceWith(t,e){const s=i.parent(t);if(s){for(const r of e){const e=this._clone(r,!0);i.insertBefore(s,e,t)}this._remove(t),i.removeChild(s,t)}}}),Object.assign(n,{_unwrap(t){const s=i.parent(t);if(!s)return;const r=e.wrap(i.childNodes(t));for(const e of r)i.insertBefore(s,e,t);this._remove(t),i.removeChild(s,t)},_wrap(t,e){const s=i.parent(t);if(!s)return;const r=e.map(t=>this._clone(t,!0));for(const e of r)i.insertBefore(s,e,t);const o=this._deepest(r.shift());i.insertBefore(o,t)},_wrapAll(t,e){const s=t.slice().shift();if(!s)return;const r=i.parent(s);if(!r)return;for(const t of e)i.insertBefore(r,t,s);const o=n._deepest(e.shift());for(const e of t)i.insertBefore(o,e)},_wrapInner(t,s){const r=e.wrap(i.childNodes(t)),o=s.map(t=>this._clone(t,!0));for(const e of o)i.insertBefore(t,e);const n=this._deepest(o.shift());for(const t of r)i.insertBefore(n,t)}}),Object.assign(n,{parseHTML:t=>(new DOMParser).parseFromString(t,"text/html"),parseXML:t=>(new DOMParser).parseFromString(t,"application/xml")}),Object.assign(n,{_findBySelector(t,s){const r=[];for(const o of s)e.merge(r,i.findBySelector(t,o));return s.length>1&&r.length>1?e.unique(r):r},_findOneBySelector(t,e){for(const s of e){const e=i.findOneBySelector(t,s);if(e)return e}return null}}),Object.assign(n,{_children(t,s,r=!1,o=!1){const n=e.wrap(o?i.children(t):i.childNodes(t)),a=[];let c;for(c of n)if((!s||s(c))&&(a.push(c),r))break;return a},_deepest:t=>e.wrap(i.findBySelector("*",t)).find(t=>!i.hasChildren(t))||t,_next(t,e){const s=[];return(t=i.next(t))?(e&&!e(t)||s.push(t),s):s},_nextAll(t,e,s,r=!1){const o=[];for(;(t=i.next(t))&&(!s||!s(t))&&(e&&!e(t)||(o.push(t),!r)););return o},_parent(t,e){const s=[],r=i.parent(t);return r?(e&&!e(r)||s.push(r),s):s},_parents(t,s,r,o=!1){const n=[];for(;(t=i.parent(t))&&!e.isDocument(t)&&(!r||!r(t))&&(s&&!s(t)||(n.unshift(t),!o)););return n},_prev(t,e){const s=[];return(t=i.prev(t))?(e&&!e(t)||s.push(t),s):s},_prevAll(t,e,s,r=!1){const o=[];for(;(t=i.prev(t))&&(!s||!s(t))&&(e&&!e(t)||(o.unshift(t),!r)););return o},_siblings(t,e,s=!0){const r=[],o=i.parent(t);if(!o)return r;const n=s?o.children:o.childNodes;let a;for(a of n)i.isSame(t,a)||e&&!e(a)||r.push(a);return r}}),Object.assign(n,{parseNodesFactory:t=>t?s=>(t.node?e.isNode(s):e.isElement(s))||t.fragment&&e.isFragment(s)||t.shadow&&e.isShadow(s)||t.document&&e.isDocument(s)||t.window&&e.isWindow(s):e.isElement}),Object.assign(n,{_hasAnimation(t){return this._animations.has(t)},_hasCSSAnimation(t){return!!parseFloat(this._css(t,"animation-duration"))},_hasCSSTransition(t){return!!parseFloat(this._css(t,"transition-duration"))},_hasData(t,e){return this._data.has(t)&&(!e||this._data.get(t).hasOwnProperty(e))},_hasFragment:t=>!!i.fragment(t),_hasShadow:t=>!!i.shadow(t),_isVisible:t=>e.isWindow(t)?i._isVisibleDocument(i.document(t)):e.isDocument(t)?i.isVisibleDocument(t):!!i.offsetParent(t)}),Object.assign(n,{_forceShow(t,s){if(e.isDocument(t)||e.isWindow(t)||this._isVisible(t))return s(t);const r=[];e.isElement(t)&&"none"===this._css(t,"display")&&r.push(t),e.merge(r,this._parents(t,t=>e.isElement(t)&&"none"===this._css(t,"display")));const o=new Map;for(const t of r)o.set(t,i.getAttribute(t,"style")),i.setStyle(t,"display","initial",!0);const n=s(t);for(const[t,e]of o)e?i.setAttribute(t,"style",e):i.removeAttribute(t,"style");return n},_sanitize(t,e,s=this.allowedTags){const r=this._tagName(t);if(!(r in s))return void i.removeChild(e,t);const o=[];"*"in s&&s["*"].length&&o.push(...s["*"]),s[r].length&&o.push(...s[r]);const n=this._getAttribute(t);for(const e in n){!!o.find(t=>e.match(t))||i.removeAttribute(t,e)}const a=this._children(t,null,!1,!0);for(const e of a)this._sanitize(e,t,s)},_tagName:t=>i.tagName(t).toLowerCase()}),Object.assign(n,{_animating:!1,_animations:new Map,_queues:new WeakMap,_data:new WeakMap,_events:new WeakMap,_styles:new WeakMap,allowedTags:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},animationDefaults:{duration:1e3,type:"ease-in-out",infinite:!1},cssNumberProperties:["font-weight","line-height","opacity","orphans","widows","z-index"],INNER:0,OUTER:2,OUTER_MARGIN:3,_complexRegExp:/(?:^\s*[\>\+\~]|\,(?=(?:(?:[^"']*["']){2})*[^"']*$)\s*[\>\+\~])/,_fastRegExp:/^([\#\.]?)([\w\-]+)$/,_splitRegExp:/\,(?=(?:(?:[^"]*"){2})*[^"]*$)\s*/});class i{}return Object.assign(i,{attributes:t=>t.attributes,dataset:t=>t.dataset,getAttribute:(t,e)=>t.getAttribute(e),getDataset(t,e){return this.dataset(t)[e]},getProperty:(t,e)=>t[e],removeAttribute(t,e){t.removeAttribute(e)},removeDataset(t,e){delete t.dataset[e]},removeProperty(t,e){delete t[e]},setAttribute(t,e,s){t.setAttribute(e,s)},setDataset(t,e,s){this.dataset(t)[e]=s},setProperty(t,e,s){t[e]=s}}),Object.assign(i,{offsetLeft:t=>t.offsetLeft,offsetTop:t=>t.offsetTop,rect:t=>t.getBoundingClientRect()}),Object.assign(i,{getScrollX:t=>t.scrollLeft,getScrollXWindow:t=>t.scrollX,getScrollY:t=>t.scrollTop,getScrollYWindow:t=>t.scrollY,setScrollWindow:(t,e,s)=>t.scroll(e,s),setScrollX(t,e){t.scrollLeft=e},setScrollY(t,e){t.scrollTop=e}}),Object.assign(i,{height:t=>t.clientHeight,heightWindow:(t,e)=>e?t.outerHeight:t.innerHeight,width:t=>t.clientWidth,widthWindow:(t,e)=>e?t.outerWidth:t.innerWidth}),Object.assign(i,{addClass(t,...e){t.classList.add(...e)},css:e=>t.getComputedStyle(e),getStyle(t,e){return this.style(t)[e]},removeClass(t,...e){t.classList.remove(...e)},setStyle(t,e,s,r){t.style.setProperty(e,s,r?"important":"")},style:t=>t.style,toggleClass(t,...e){t.classList.toggle(...e)}}),Object.assign(i,{blur(t){t.blur()},click(t){t.click()},focus(t){t.focus()}}),Object.assign(i,{addEvent(t,e,s){t.addEventListener(e,s)},removeEvent(t,e,s){t.removeEventListener(e,s)},triggerEvent(t,e,s,r){const o=new Event(e,{bubbles:!0,cancelable:!0,...r});return s&&Object.assign(o,s),t.dispatchEvent(o)}}),Object.assign(i,{attachShadow:(t,e=!0)=>t.attachShadow({mode:e?"open":"closed"}),create:(t,e)=>t.createElement(e),createComment:(t,e)=>t.createComment(e),createFragment:t=>t.createDocumentFragment(),createRange:t=>t.createRange(),createText:(t,e)=>t.createTextNode(e)}),Object.assign(i,{clone:(t,e)=>t.cloneNode(e),removeChild(t,e){t.removeChild(e)}}),Object.assign(i,{insertBefore(t,e,s=null){t.insertBefore(e,s)}}),Object.assign(i,{findByClass:(t,e)=>e.getElementsByClassName(t),findById:(t,e)=>e.getElementById(t),findByTag:(t,e)=>e.getElementsByTagName(t),findBySelector:(t,e)=>e.querySelectorAll(t),findOneBySelector:(t,e)=>e.querySelector(t)}),Object.assign(i,{childNodes:t=>t.childNodes,children:t=>t.children,document:t=>t.document,documentElement:t=>t.documentElement,firstChild:t=>t.firstChild,fragment:t=>t.content,next:t=>t.nextSibling,offsetParent:t=>t.offsetParent,parent:t=>t.parentNode,prev:t=>t.previousSibling,scrollingElement:t=>t.scrollingElement,shadow:t=>t.shadowRoot}),Object.assign(i,{addRange(t,e){t.addRange(e)},collapse(t){t.collapse()},endContainer:t=>t.endContainer,extract:t=>t.extractContents(),getRange:(t,e=0)=>t.getRangeAt(e),getSelection:()=>t.getSelection(),insert(t,e){t.insertNode(e)},rangeCount:t=>t.rangeCount,removeRanges(t){t.removeAllRanges()},select(t,e){t.selectNode(e)},setEndAfter(t,e){t.setEndAfter(e)},setStartBefore(t,e){t.setStartBefore(e)},startContainer:t=>t.startContainer}),Object.assign(i,{contains:(t,e)=>t.contains(e),hasAttribute:(t,e)=>t.hasAttribute(e),hasChildren:t=>!!t.childElementCount,hasClass:(t,e)=>t.classList.contains(e),hasProperty:(t,e)=>t.hasOwnProperty(e),is:(t,s)=>e.isElement(t)&&t.matches(s),isConnected:t=>t.isConnected,isEqual:(t,e)=>t.isEqualNode(e),isSame:(t,e)=>t.isSameNode(e),isVisibleDocument:t=>"visible"===t.visibilityState}),Object.assign(i,{comparePosition:(t,e)=>t.compareDocumentPosition(e),normalize(t){t.normalize()},tagName:t=>t.tagName}),{AjaxRequest:r,DOM:n,DOMNode:i,dom:new n}}));